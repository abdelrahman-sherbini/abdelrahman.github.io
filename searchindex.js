Search.setIndex({"docnames": ["index", "lab1/lab1", "lab10/lab10", "lab11/lab11", "lab12/lab12", "lab3/lab3", "lab5/lab5", "lab6/lab6", "lab7/lab7", "lab9/lab9"], "filenames": ["index.rst", "lab1\\lab1.rst", "lab10\\lab10.rst", "lab11\\lab11.rst", "lab12\\lab12.rst", "lab3\\lab3.rst", "lab5\\lab5.rst", "lab6\\lab6.rst", "lab7\\lab7.rst", "lab9\\lab9.rst"], "titles": ["Welcome to my PMA walkthrough!", "Practical Malware Analysis - Lab 1", "Practical Malware Analysis - Lab 10", "Practical Malware Analysis - Lab 11", "Practical Malware Analysis - Lab 12", "Practical Malware Analysis - Lab 3", "Practical Malware Analysis - Lab 5", "Practical Malware Analysis - Lab 6", "Practical Malware Analysis - Lab 7", "Practical Malware Analysis - Lab 9"], "terms": {"index": 0, "modul": [0, 1, 3, 6], "search": [0, 1, 3, 5, 6, 8, 9], "page": [0, 6], "practic": 0, "malwar": 0, "analysi": 0, "lab": 0, "1": 0, "thi": [1, 2, 3, 4, 5, 6, 7, 8, 9], "us": [1, 2, 3, 4, 5, 6, 7, 8, 9], "file": [1, 2, 3, 4, 5, 6, 7, 8, 9], "lab01": 1, "01": [1, 2, 3, 4, 5, 6, 7, 8, 9], "ex": [1, 2, 3, 4, 5, 6, 7, 8, 9], "dll": [1, 3, 4, 5, 6, 8, 9], "tool": [1, 5], "techniqu": [1, 3, 9], "describ": 1, "chapter": [1, 5, 7, 9], "gain": 1, "inform": [1, 5, 6], "about": [1, 3, 6], "answer": [1, 3, 9], "question": [1, 6, 7, 9], "below": 1, "q1": [1, 2, 3, 4, 5, 6, 7, 8, 9], "upload": 1, "http": [1, 3, 4, 6, 8, 9], "www": [1, 3, 8, 9], "virustot": 1, "com": [1, 4, 6, 7, 8, 9], "view": [1, 3, 6, 9], "report": 1, "doe": [1, 2, 3, 4, 6, 7, 8, 9], "either": 1, "match": [1, 6, 9], "ani": [1, 2, 3, 5, 6, 7, 8, 9], "exist": 1, "antiviru": 1, "signatur": [1, 5, 8, 9], "45": 1, "vendor": 1, "flag": [1, 6], "suspici": [1, 3], "55": 1, "imag": 3, "1ex": [], "png": 3, "2": [0, 6], "3": [0, 6], "4": [0, 6, 9], "q2": [1, 2, 3, 4, 5, 6, 7, 8, 9], "when": [1, 2, 3, 4, 5, 6, 7, 8, 9], "were": [1, 3, 8], "compil": 1, "q3": [1, 2, 3, 4, 5, 6, 7, 8, 9], "ar": [1, 2, 3, 4, 5, 6, 7, 8, 9], "indic": [1, 5, 7, 8, 9], "i": [1, 2, 3, 4, 5, 6, 7, 8, 9], "pack": [1, 5], "obfusc": [1, 9], "If": [1, 2, 3, 5, 6, 7, 8], "so": [1, 2, 3, 4, 5, 6, 7, 8, 9], "what": [1, 2, 3, 4, 5, 6, 7, 8, 9], "q4": [1, 3, 4, 5, 6, 7, 8, 9], "do": [1, 2, 3, 4, 5, 6, 7, 8, 9], "import": [1, 3, 4, 5, 6, 8, 9], "hint": [1, 6], "which": [1, 2, 3, 4, 5, 6, 7, 8, 9], "thei": [1, 2, 4, 5, 6], "q5": [1, 3, 4, 5, 6, 7, 8, 9], "q6": [1, 3, 4, 5, 6, 7, 8, 9], "network": [1, 5, 6, 7, 8, 9], "base": [1, 3, 4, 5, 6, 7, 8, 9], "could": [1, 4, 5, 6, 8, 9], "find": [1, 3, 4, 5, 6, 8, 9], "infect": [1, 3], "machin": [1, 2, 3, 8], "q7": [1, 3, 6, 9], "would": [1, 3, 5], "you": [1, 2, 3, 4, 5, 6, 7, 8, 9], "guess": 1, "purpos": [1, 3, 4, 5, 7, 8, 9], "analyz": [1, 3, 4, 5, 6, 7, 8, 9], "02": [1, 2, 3, 4, 5, 7, 8, 9], "definit": 1, "unpack": 1, "possibl": 1, "program": [1, 2, 4, 5, 6, 7, 8, 9], "": [1, 3, 5, 6, 7, 8, 9], "function": [1, 2, 3, 4, 6, 7, 8, 9], "tell": 1, "host": [1, 2, 5, 7, 8, 9], "identifi": [1, 4, 5, 6, 9], "03": [1, 2, 3, 4, 5, 7, 8, 9], "04": [1, 4, 5, 7], "wa": [1, 2, 3, 6, 9], "ha": [1, 4, 6, 7, 9], "one": [1, 3, 4, 6, 7, 8, 9], "resourc": [1, 3], "section": 1, "hacker": 1, "examin": [1, 2, 3], "extract": [1, 3, 4], "can": [1, 2, 3, 4, 5, 6, 7, 8, 9], "learn": [1, 4, 6], "from": [1, 2, 3, 5, 6, 7, 9], "sun": 1, "dec": 1, "19": 1, "18": 1, "16": [1, 3], "2010": 1, "38": 1, "peid": 1, "moreov": 1, "both": [1, 2, 3, 8, 9], "decent": 1, "number": [1, 4, 6], "psstudio": 1, "check": [1, 2, 3, 4, 6, 7, 8, 9], "show": [1, 9], "creat": [1, 2, 3, 4, 5, 6, 7, 8, 9], "ws2_32": 1, "socket": [1, 6], "mean": [1, 2, 3], "we": [1, 2, 3, 4, 5, 6, 7, 8, 9], "need": [1, 2, 3, 6, 8, 9], "investig": 1, "traffic": [1, 5, 6], "also": [1, 3, 6], "createprocess": 1, "kernel32": [1, 5, 8, 9], "new": [1, 3, 7], "process": [1, 3, 4, 5, 6, 8, 9], "spawn": 1, "ye": [1, 7], "findfirstfil": 1, "findnextfil": 1, "u": [1, 4, 6], "somefil": 1, "modifi": [1, 3, 4], "run": [1, 2, 3, 4, 5, 6, 7, 8, 9], "string": [1, 3, 4, 5, 6, 7, 8, 9], "give": [1, 6], "some": [1, 3, 4, 5, 6, 8, 9], "useful": 1, "like": [1, 3, 4, 5, 6, 7, 8, 9], "ip": [1, 8], "127": [1, 8], "26": [1, 8], "152": [1, 8], "13": [1, 6, 8], "watch": [1, 6], "come": 1, "kerne132": [1, 8], "l": [1, 9], "should": [1, 3, 6, 7, 8], "notic": [1, 3, 4, 5, 6, 8, 9], "sleep": [1, 3, 6, 7], "exec": 1, "mai": [1, 3, 6, 8, 9], "its": [1, 3, 4, 6, 8, 9], "an": [1, 2, 3, 6, 9], "agent": [1, 7, 8], "connect": [1, 5, 7, 8], "c": [1, 2, 3, 6, 7, 8, 9], "server": 1, "trojan": 1, "against": 1, "upx": 1, "bash": [], "d": [1, 7], "code": [3, 4, 6, 7, 9], "block": [], "createservic": 1, "startservic": [1, 8], "start": [1, 2, 3, 5, 6, 7, 8, 9], "servic": [1, 2, 8, 9], "internetopenurl": 1, "internetopen": 1, "open": [1, 2, 3, 6, 8, 9], "specifi": [1, 3, 6, 9], "complet": [1, 3], "ftp": 1, "url": [1, 7, 8], "getmodulefilenam": 1, "obtain": [1, 8], "fulli": 1, "qualifi": 1, "name": [1, 2, 3, 4, 5, 6, 8, 9], "given": 1, "handl": [1, 3, 4, 8], "see": [1, 2, 3, 4, 6, 7, 8, 9], "internet": [1, 7, 8], "explor": [1, 4, 5, 7, 8], "malwareanalysisbook": [1, 8], "8": [1, 8], "0": [1, 6], "64": 1, "av": 1, "fsg": 1, "dulek": [], "look": [1, 3, 4, 6, 9], "manual": 1, "onli": [1, 4, 5, 6, 7, 8], "loadlibrari": [1, 4], "getprocaddress": [1, 3], "t": [1, 3, 4, 5, 6, 8, 9], "63": 1, "No": 1, "malform": 1, "virtuals": 1, "close": 1, "rawsiz": 1, "sat": 1, "aug": 1, "31": [1, 9], "00": 1, "59": 1, "2019": 1, "It": [1, 3, 5, 6, 7, 8, 9], "lookup": 1, "privileg": [1, 3], "adjust": 1, "token": 1, "control": [1, 8], "most": [1, 3, 5, 6, 7], "wupdmgrd": 1, "download": 1, "thepracticalmalwareanalysi": 1, "updat": [1, 3], "There": [1, 6, 7], "binari": [1, 3, 9], "rsrc": [1, 3], "urldownloadtofil": 1, "first": [3, 4, 5, 6, 7, 8, 9], "my": [3, 5], "setup": [5, 8], "two": [5, 7, 8], "vm": [5, 6], "win7": 5, "linux": 5, "togeth": 5, "vmnet": [], "inetsim": 5, "On": [4, 5], "procmon": [2, 3, 4, 5, 9], "set": [2, 3, 4, 5, 6, 7, 8, 9], "filter": [2, 5], "execut": [2, 3, 4, 5, 6, 7, 8, 9], "clear": [3, 5], "out": [3, 5, 6, 7, 9], "all": [3, 4, 5, 6, 8, 9], "event": 5, "just": [3, 5], "befor": [5, 6, 7], "gather": [5, 6], "snapshot": [3, 5, 6, 8], "registri": [2, 3, 5, 7], "regshot": 5, "up": [4, 5, 6], "log": [3, 5], "wireshark": [3, 5], "apatedn": 5, "point": [3, 5], "found": [2, 3, 4, 5, 6, 7, 8, 9], "lab03": 5, "basic": [3, 5, 9], "dynam": [3, 5, 8, 9], "how": [2, 3, 4, 5, 6, 7, 8, 9], "get": [3, 4, 5, 6, 8, 9], "instal": [3, 5, 6, 8, 9], "itself": [4, 5, 9], "after": [2, 3, 5, 6, 7, 8, 9], "under": [3, 5, 8, 9], "order": [2, 3, 5, 8], "glean": 5, "while": [5, 9], "monitor": [3, 5], "safe": 5, "environ": [3, 5], "live": 5, "memori": [2, 3, 4, 5, 8, 9], "modif": 5, "further": [5, 6], "9": [0, 5, 6], "happen": [3, 4, 5, 6, 9], "caus": [5, 8], "roadblock": 5, "other": [5, 6, 7, 8], "wai": [3, 5, 8], "pebear": 5, "exitprocess": 5, "dl": 5, "command": [4, 5, 7, 8, 9], "mani": [3, 5, 6, 9], "domain": [5, 9], "intern": 5, "driver": [2, 5], "By": [4, 5, 6, 8, 9], "utilt": 5, "rundll32": [3, 5], "sc": [5, 8], "parent": 5, "pid": [4, 5], "delet": [5, 7, 9], "processcr": 5, "call": [2, 3, 4, 5, 6, 7, 8, 9], "cmd": [3, 4, 5, 6, 9], "requir": [4, 5, 9], "certain": [3, 5, 8], "condit": [3, 5, 7, 9], "line": [5, 6, 9], "argument": [2, 3, 4, 5, 6, 7, 9], "don": [4, 5], "know": [2, 5, 8], "stage": 5, "util": [6, 8, 9], "ida": [2, 3, 4, 6, 9], "lab05": 6, "pro": [6, 9], "The": [2, 3, 6, 7, 9], "goal": [6, 7], "hand": 6, "experi": 6, "ve": [6, 7, 8], "alreadi": [2, 6], "work": [2, 3, 6, 7], "choos": 6, "ignor": 6, "focu": [6, 8], "revers": [6, 8], "engin": 6, "5": [0, 3, 7], "address": [3, 4, 6, 7, 8, 9], "dllmain": [3, 6, 8], "window": [2, 3, 4, 6, 7, 8], "brows": 6, "gethostbynam": 6, "where": [2, 3, 4, 6, 9], "locat": [3, 4, 6, 7, 9], "focus": 6, "0x10001757": 6, "figur": 6, "dn": 6, "request": [6, 9], "made": [6, 7], "local": [6, 8], "variabl": 6, "recogn": [6, 7], "subroutin": [6, 7, 8, 9], "0x10001656": 6, "6": [0, 6, 9], "paramet": [3, 4, 6, 7, 9], "7": [0, 3], "disassembli": 6, "area": 6, "refer": [3, 6], "In": [6, 7, 8, 9], "same": [2, 3, 4, 6, 7, 8, 9], "0x100101c8": 6, "dword_1008e5c4": 6, "global": 6, "help": [3, 6, 7], "decid": 6, "path": [3, 6, 9], "take": [3, 6, 7, 9], "cross": [3, 6], "10": 0, "A": [6, 7, 8], "few": 6, "hundr": 6, "0x1000ff58": 6, "seri": 6, "comparison": 6, "memcmp": [3, 6], "compar": [3, 4, 6, 7, 9], "robotwork": 6, "success": [2, 6, 7, 8], "return": [2, 3, 4, 6, 7, 9], "11": 0, "export": [3, 6], "pslist": 6, "12": 0, "graph": 6, "mode": [3, 6], "sub_10004e79": 6, "api": 6, "enter": 6, "alon": 6, "renam": [6, 9], "directli": 6, "depth": 6, "14": [], "At": [6, 8], "0x10001358": 6, "contain": [3, 6, 7, 8], "millisecond": 6, "backward": 6, "through": [6, 7, 8], "long": [6, 7], "15": [], "0x10001701": 6, "three": [3, 6, 9], "q8": [3, 6, 9], "q9": [3, 6], "q10": 6, "q11": 6, "q12": 6, "q13": 6, "q14": 6, "q15": 6, "load": [3, 4, 6, 9], "direct": [2, 6], "1000d02e": 6, "referenc": 6, "100163cc": 6, "xref": 6, "press": [3, 6], "x": 6, "idata": 6, "time": [3, 6, 7, 8], "uniqu": 6, "method": [6, 7, 8], "g": 6, "jump": [3, 6, 7], "scroll": 6, "push": [6, 7], "eax": [2, 3, 6, 7, 9], "data": [3, 6, 8, 9], "ad": [6, 7, 8], "0x0d": 6, "decim": 6, "go": [2, 3, 4, 6, 7, 8, 9], "click": 6, "twice": 6, "undefin": [3, 6], "place": [2, 3, 6], "redefin": 6, "offset": [3, 6, 8], "pic": 6, "praticalmalwareanalysi": 6, "24": 6, "pass": [3, 4, 6, 7, 8, 9], "posit": 6, "valu": [3, 6, 9], "respect": 6, "ebp": [3, 6], "neg": 6, "lpthreadparamet": 6, "100101d0": 6, "hi": 6, "master": 6, "remot": [4, 6, 8], "shell": 6, "sound": [3, 6], "session": 6, "1001009d": 6, "doubl": 6, "mov": [6, 9], "begin": [6, 8], "initi": [6, 9], "stack": [6, 9], "alloc": [3, 4, 6], "space": [2, 3, 4, 6], "Then": [2, 6, 7, 8], "structur": [3, 6], "versioninform": 6, "pointer": 6, "getversionexa": 6, "zero": [2, 3, 6], "dwplatformid": 6, "equal": [6, 9], "true": 6, "fals": 6, "al": [6, 7], "regist": [6, 8, 9], "result": [2, 3, 6], "overal": [6, 7], "o": [6, 7], "win32nt": 6, "act": 6, "text": 6, "test": [3, 6, 9], "jnz": [6, 7], "next": [6, 7], "instruct": [3, 6, 7, 9], "flow": [3, 6, 9], "sub_100052a2": 6, "routin": [3, 6, 7, 9], "type": [2, 3, 6, 7], "buffer": [3, 4, 6], "send": [3, 6, 8], "over": [3, 4, 6, 9], "try": [6, 7], "registeri": 6, "softwar": [3, 6, 7, 8], "microsoft": [3, 4, 6, 7], "currentvers": [3, 6, 7], "regopenkeyexa": 6, "jz": [6, 7], "loc_10005309": 6, "10005322": 6, "queri": [6, 9], "worktim": 6, "sent": [3, 6], "vaiabl": 6, "dword_1008e5bc": 6, "sub_100036c3": 6, "cmp": [6, 7], "majorvers": 6, "jb": 6, "short": 6, "loc_100036fa": 6, "version": [6, 8], "less": 6, "than": [6, 8], "cf": 6, "goe": 6, "piec": [6, 7, 9], "str": 6, "isnot": 6, "null": 6, "empti": 6, "strlen": 6, "zf": 6, "taken": [6, 8], "non": [2, 6], "1000664c": 6, "10006518": 6, "createtoolhelp32snapshot": 6, "well": [3, 6], "heap": [3, 6], "thread": [3, 4, 6, 8], "processentry32": [3, 6], "put": [2, 3, 6, 7, 9], "loop": [3, 6, 7, 8, 9], "pe": 6, "szexefil": 6, "those": [3, 6, 7], "branch": [6, 9], "seem": [3, 6], "without": [6, 8], "langaug": 6, "getsystemlanguageid": 6, "sprintf": 6, "sub_100038e": 6, "send_languageid": 6, "For": [6, 8], "win": [3, 6], "lot": [3, 4, 6], "10019020": 6, "cti": 6, "30": 6, "move": [6, 9], "add": [3, 6], "convert": [4, 6, 9], "int": 6, "multipli": 6, "1000": 6, "second": [3, 4, 6, 7, 9], "protocol": 6, "af": 6, "q16": 6, "msdn": [4, 6], "symbol": 6, "constant": [3, 6], "make": [2, 3, 4, 6, 8, 9], "more": [3, 6, 7, 8], "meaning": 6, "appli": 6, "chang": [2, 3, 6, 8], "q17": 6, "usag": 6, "opcod": [3, 6], "0xed": 6, "magic": 6, "vmxh": 6, "perform": [4, 6, 7], "vmware": 6, "detect": [6, 8], "evid": 6, "q18": 6, "your": [3, 6, 8], "cursor": 6, "0x1001d988": 6, "q19": 6, "have": [2, 3, 6], "python": 6, "plug": 6, "includ": [2, 6, 9], "commerci": 6, "py": 6, "script": 6, "provid": [3, 6, 9], "book": 6, "sure": [3, 4, 6], "q20": 6, "With": 6, "turn": 6, "singl": [4, 6, 7], "ascii": [6, 7, 9], "q21": 6, "editor": 6, "_target": 6, "en": [4, 6], "win32": [4, 6], "winsock2": 6, "nf": 6, "right": [3, 6], "alt": 6, "b": [6, 7], "byte": [3, 4, 6, 7], "occur": 6, "sub_10006196": 6, "hex": [6, 9], "cancel": 6, "charact": [3, 6], "outdat": 6, "xor": [6, 9], "0x55": 6, "default": [6, 7], "format": [3, 6, 7], "current": [3, 6, 7], "select": 6, "screen": 6, "0x50": 6, "understand": 7, "construct": 7, "each": 7, "guid": 7, "discov": [3, 7], "build": 7, "previou": [7, 8], "thu": 7, "complic": 7, "four": 7, "onc": [2, 7, 8], "finish": [7, 8], "abl": 7, "easili": 7, "individu": 7, "encount": 7, "them": [3, 7], "lab06": 7, "major": 7, "main": [3, 4, 7, 8, 9], "print": [3, 7, 9], "state": 7, "output": [7, 9], "0x40105f": 7, "oper": [3, 4, 7], "0x40117f": 7, "ll": [7, 8], "differ": [7, 9], "between": [3, 7], "been": 7, "pars": 7, "html": [7, 8], "assum": [3, 7], "abov": [3, 4], "stream": 7, "fail": [2, 7], "printf": 7, "here": [2, 3, 4, 7, 8, 9], "tri": 7, "openurl": 7, "practicalmalwareanalysi": [7, 9], "v7": [3, 4, 7], "depend": 7, "continu": [3, 7, 8], "internetreadfil": 7, "read": [3, 7], "200": 7, "readfil": 7, "bye": 7, "0x3c": 7, "receiv": 7, "combin": [7, 8], "bunch": 7, "switch": 7, "case": 7, "user": [2, 3, 7, 8], "As": [7, 9], "summari": 7, "pma": 7, "cc": [7, 9], "htm": [3, 7], "401130": 7, "lpexistingfil": 7, "char": 7, "argv": [7, 9], "arrai": 7, "lower": 7, "401040": [7, 8], "input": [3, 7], "directori": [2, 3, 4, 7, 8], "temp": 7, "copi": [3, 7, 8], "kei": [3, 7, 9], "persist": [3, 7, 8], "startup": [7, 8], "e": [3, 7, 9], "100": 7, "error": 7, "multipl": [3, 7], "thing": 7, "retriev": 7, "site": [7, 8], "1440": 7, "counter": 7, "var_c": 7, "parser": 7, "throughtout": 7, "dai": [3, 7], "interv": 7, "lab07": 8, "ensur": 8, "achiev": [3, 8], "comput": [2, 8], "restart": [4, 8], "why": [3, 8], "mutex": [3, 8], "good": 8, "malici": [4, 8, 9], "prior": 8, "note": 8, "becaus": [2, 3, 8], "might": [3, 8], "victim": [2, 8], "visibl": 8, "loopback": 8, "real": 8, "localhost": 8, "protect": [3, 4, 8], "warn": 8, "consider": 8, "damag": 8, "difficult": 8, "remov": 8, "virtual": 8, "bit": [3, 8], "challeng": 8, "ones": 8, "static": [3, 8, 9], "big": 8, "pictur": 8, "avoid": [8, 9], "bog": 8, "down": 8, "detail": 8, "Into": 8, "startservicectrldispatchera": 8, "manag": [8, 9], "instanc": 8, "startyp": 8, "autostart": 8, "pc": 8, "To": 8, "hardcod": 8, "must": [2, 3, 8], "consist": 8, "aren": 8, "commun": 8, "qc": 8, "malservic": 8, "hgl345": 8, "waitforsingleobject": 8, "waitabl": 8, "timer": 8, "wait": 8, "2100": 8, "834h": 8, "4010de": 8, "reach": [8, 9], "year": 8, "20": [3, 8], "zombi": 8, "botnet": 8, "infinit": 8, "never": 8, "object": 8, "oleiniti": 8, "cocreateinst": 8, "our": [8, 9], "hkey_local_machin": 8, "class": 8, "clsid": 8, "2df01": 8, "mayb": [3, 4, 8], "adwar": 8, "now": [3, 4, 8, 9], "eplor": 8, "uninti": 8, "normal": [3, 8], "ioc": 8, "system32": [2, 3, 8, 9], "map": [3, 4, 8], "reflect": 8, "disk": [3, 8], "And": 8, "132": 8, "l32": 8, "4011e0": 8, "iter": 8, "string2": 8, "replac": [3, 8], "dword_403010": 8, "qmemcpi": 8, "ping": 8, "pong": 8, "reciev": 8, "overwrit": [3, 8], "instead": 8, "sadfhuhf": 8, "inject": [3, 4, 8], "logic": [2, 8], "Or": 8, "easier": [8, 9], "lab09": 9, "ollydbg": [3, 9], "follow": 9, "option": 9, "password": 9, "perman": 9, "patch": 9, "doesn": [3, 9], "special": 9, "action": 9, "via": 9, "sampl": 9, "payload": [4, 9], "0x00401133": 9, "being": [3, 4, 9], "0x00401089": 9, "encod": 9, "signific": [3, 9], "createprocessa": 9, "0x0040106e": 9, "dll1": 9, "dll2": 9, "dll3": 9, "built": 9, "therefor": 9, "versu": 9, "appear": 9, "comfort": 9, "correct": 9, "within": 9, "debug": [3, 9], "assign": 9, "writefil": 9, "filenam": [3, 9], "write": [3, 4, 9], "job": 9, "netschedulejobadd": 9, "mysteri": 9, "sub_402410": 9, "del": 9, "respons": [3, 9], "last": 9, "argc": 9, "abcd": 9, "passkei": 9, "n": 9, "r": 9, "involv": 9, "around": 9, "re": 9, "opposit": 9, "suppli": 9, "xp": [3, 9], "subkei": 9, "arugu": 9, "qw": 9, "402af0": 9, "step": 9, "till": 9, "sinc": 9, "skip": 9, "selfdelet": 9, "arriv": 9, "prepar": [4, 9], "servicemanag": 9, "dir": 9, "syswow": [3, 9], "systemroot": 9, "windowssystem32": [2, 3, 9], "hklmsoftwaremicrosoft": 9, "noth": 9, "foreground": 9, "someth": [3, 9], "ocl": 9, "termin": [4, 9], "bp": [3, 9], "401133": 9, "breakpoint": [2, 9], "gonna": 9, "decod": [3, 9], "46": 9, "letter": 9, "dump": 9, "anywher": 2, "properli": [2, 3], "origin": 2, "lab10": 2, "sy": 2, "controlservic": 2, "windbg": 2, "kernel": 2, "compon": 2, "stop": [2, 3, 4], "regsetvalu": 2, "0x01": 2, "service_kernel_driv": 2, "0x00000001": 2, "couldnt": 2, "dwcontrol": 2, "service_control_stop": 2, "still": 2, "hit": 2, "break": 2, "lab11": 3, "drop": [3, 4], "rep": 3, "stosd": 3, "ecx": 3, "43h": 3, "tgad": 3, "pestudio": 3, "loadresourc": 3, "40100": [3, 4], "gina": 3, "intercept": 3, "regset": 3, "ginadl": 3, "winlogon": 3, "steal": 3, "credenti": 3, "exeinfo": 3, "floss": 3, "oringin": 3, "stolen": 3, "msutil": 3, "ini": 3, "attempt": 3, "permiss": 3, "resid": 3, "rootkit": 3, "emploi": 3, "hook": 3, "attack": 3, "captur": 3, "activ": 3, "dure": [3, 4], "interest": 3, "lead": 3, "system": 3, "store": [3, 4], "collect": 3, "similar": 3, "caller": 3, "appleinit": 3, "stood": 3, "modulefilenam": 3, "processid": 3, "plu": 3, "snapshottool": 3, "100012fe": 3, "wsock32": 3, "got": 3, "10001203": 3, "virtualprotect": 3, "inlin": 3, "insid": 3, "calcul": [3, 4], "distanc": 3, "arg_4": 3, "sendaddr": 3, "0xff": 3, "lpaddress": 3, "rel": 3, "rest": 3, "0xe9": 3, "jmp": 3, "v6": 3, "trace": 3, "back": 3, "1000113d": 3, "substr": 3, "rept": 3, "els": 3, "recepi": 3, "email": 3, "100034a0": [], "destin": 3, "gibberish": 3, "100010b3": 3, "de": 3, "loaddll": 3, "outlook": 3, "mark": 3, "keylogg": 3, "record": 3, "save": [3, 4], "manipul": 3, "ofc": 3, "inet_epar32": 3, "cisvc": 3, "lpfilenam": 3, "lea": 3, "401070": 3, "full": 3, "windowssystem32cisvc": 3, "409030": 3, "mem": 3, "simpl": 3, "memcopi": 3, "reveal": 3, "assembli": 3, "syswow64": 3, "ran": 3, "had": 3, "didnt": 3, "meant": 3, "10001000": 3, "getasyncst": 3, "kernel64": 3, "kernel64x": 3, "a1": 3, "shift": 3, "cap": 3, "lock": 3, "left": 3, "160": 3, "161": 3, "capit": 3, "content": 3, "specif": 3, "1032": 3, "field": 3, "4q1": 3, "appinit": 3, "link": 3, "librari": 3, "everi": 3, "interfac": 3, "user32": 3, "mechan": 3, "custom": 3, "allow": 3, "behavior": 3, "applic": 3, "who": 3, "elev": 3, "solid": 3, "hklm": 3, "nt": 3, "appinit_dl": 3, "third": 3, "resum": 3, "anoth": 3, "lab12": 4, "much": 4, "let": 4, "pull": 4, "createremotethread": 4, "sai": 4, "list": 4, "sub_401000": 4, "almost": 4, "printprocessnameandid": 4, "psapi": 4, "enumer": 4, "pop": 4, "launcher": 4, "hide": 4, "filesystem": 4, "residu": 4, "0x401000": 4, "accomplish": 4, "loadlibrarya": 4, "fourth": 4, "wmic": 4, "part": 4, "enumprocessmodul": 4, "enumprocess": 4, "getmodulebasenamea": 4, "suggest": 4, "dwprocessid": 4, "v14": 4, "size": 4, "dword": 4, "said": 4, "overhead": 4, "done": 4, "written": 4}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 0, "abdelrahmn": [], "walkthrough": 0, "": [], "document": [], "indic": 0, "tabl": 0, "practic": [1, 2, 3, 4, 5, 6, 7, 8, 9], "malwar": [1, 2, 3, 4, 5, 6, 7, 8, 9], "analysi": [1, 2, 3, 4, 5, 6, 7, 8, 9], "lab": [1, 2, 3, 4, 5, 6, 7, 8, 9], "1": [1, 2, 3, 4, 5, 6, 7, 8, 9], "2": [1, 2, 3, 4, 5, 7, 8, 9], "3": [1, 2, 3, 4, 5, 7, 8, 9], "4": [1, 4, 5, 7], "5": 6, "6": 7, "7": 8, "9": 9, "10": 2, "11": 3, "my": 0, "pma": 0, "12": 4}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Practical Malware Analysis - Lab 1": [[1, "practical-malware-analysis-lab-1"]], "Lab 1-1": [[1, "lab-1-1"]], "Lab 1-2": [[1, "lab-1-2"]], "Lab 1-3": [[1, "lab-1-3"]], "Lab 1-4": [[1, "lab-1-4"]], "Practical Malware Analysis - Lab 10": [[2, "practical-malware-analysis-lab-10"]], "Lab 10-1": [[2, "lab-10-1"]], "Lab 10-2": [[2, "lab-10-2"]], "Lab 10-3": [[2, "lab-10-3"]], "Practical Malware Analysis - Lab 11": [[3, "practical-malware-analysis-lab-11"]], "Lab 11-1": [[3, "lab-11-1"]], "Lab 11-2": [[3, "lab-11-2"]], "Lab 11-3": [[3, "lab-11-3"]], "Practical Malware Analysis - Lab 3": [[5, "practical-malware-analysis-lab-3"]], "Lab 3-1": [[5, "lab-3-1"]], "Lab 3-2": [[5, "lab-3-2"]], "Lab 3-3": [[5, "lab-3-3"]], "Lab 3-4": [[5, "lab-3-4"]], "Practical Malware Analysis - Lab 5": [[6, "practical-malware-analysis-lab-5"]], "Lab 5-1": [[6, "lab-5-1"]], "Practical Malware Analysis - Lab 6": [[7, "practical-malware-analysis-lab-6"]], "Lab 6-1": [[7, "lab-6-1"]], "Lab 6-2": [[7, "lab-6-2"]], "Lab 6-3": [[7, "lab-6-3"]], "Lab 6-4": [[7, "lab-6-4"]], "Practical Malware Analysis - Lab 7": [[8, "practical-malware-analysis-lab-7"]], "Lab 7-1": [[8, "lab-7-1"]], "Lab 7-2": [[8, "lab-7-2"]], "Lab 7-3": [[8, "lab-7-3"]], "Practical Malware Analysis - Lab 9": [[9, "practical-malware-analysis-lab-9"]], "Lab 9-1": [[9, "lab-9-1"]], "Lab 9-2": [[9, "lab-9-2"]], "Lab 9-3": [[9, "lab-9-3"]], "Welcome to my PMA walkthrough!": [[0, "welcome-to-my-pma-walkthrough"]], "Indices and tables": [[0, "indices-and-tables"]], "Practical Malware Analysis - Lab 12": [[4, "practical-malware-analysis-lab-12"]], "Lab 12-1": [[4, "lab-12-1"]], "Lab 12-2": [[4, "lab-12-2"]], "Lab 12-3": [[4, "lab-12-3"]], "Lab 12-4": [[4, "lab-12-4"]]}, "indexentries": {}})