Search.setIndex({"docnames": ["index", "lab1/lab1", "lab3/lab3", "lab5/lab5", "lab6/lab6", "lab7/lab7"], "filenames": ["index.rst", "lab1\\lab1.rst", "lab3\\lab3.rst", "lab5\\lab5.rst", "lab6\\lab6.rst", "lab7\\lab7.rst"], "titles": ["Welcome to abdelrahmn walkthrough!", "Practical Malware Analysis - Lab 1", "Practical Malware Analysis - Lab 3", "Practical Malware Analysis - Lab 5", "Practical Malware Analysis - Lab 6", "Practical Malware Analysis - Lab 7"], "terms": {"index": 0, "modul": [0, 1, 3], "search": [0, 1, 2, 3, 5], "page": [0, 3], "practic": 0, "malwar": 0, "analysi": 0, "lab": 0, "1": 0, "thi": [1, 2, 3, 4, 5], "us": [1, 2, 3, 4, 5], "file": [1, 2, 3, 4, 5], "lab01": 1, "01": [1, 2, 3, 4, 5], "ex": [1, 2, 3, 4, 5], "dll": [1, 2, 3, 5], "tool": [1, 2], "techniqu": 1, "describ": 1, "chapter": [1, 2, 4], "gain": 1, "inform": [1, 2, 3], "about": [1, 3], "answer": 1, "question": [1, 3, 4], "below": 1, "q1": [1, 2, 3, 4, 5], "upload": 1, "http": [1, 3, 5], "www": [1, 5], "virustot": 1, "com": [1, 3, 4, 5], "view": [1, 3], "report": 1, "doe": [1, 3, 4, 5], "either": 1, "match": [1, 3], "ani": [1, 2, 3, 4, 5], "exist": 1, "antiviru": 1, "signatur": [1, 2, 5], "45": 1, "vendor": 1, "flag": [1, 3], "suspici": 1, "55": 1, "imag": [], "1ex": [], "png": [], "2": [0, 3], "3": [0, 3], "4": [0, 3], "q2": [1, 2, 3, 4, 5], "when": [1, 2, 3, 4, 5], "were": [1, 5], "compil": 1, "q3": [1, 2, 3, 4, 5], "ar": [1, 2, 3, 4, 5], "indic": [1, 2, 4, 5], "i": [1, 2, 3, 4, 5], "pack": [1, 2], "obfusc": 1, "If": [1, 2, 3, 4, 5], "so": [1, 2, 3, 4, 5], "what": [1, 2, 3, 4, 5], "q4": [1, 2, 3, 4, 5], "do": [1, 2, 3, 4, 5], "import": [1, 2, 3, 5], "hint": [1, 3], "which": [1, 2, 3, 4, 5], "thei": [1, 2, 3], "q5": [1, 2, 3, 4, 5], "q6": [1, 2, 3, 4, 5], "network": [1, 2, 3, 4, 5], "base": [1, 2, 3, 4, 5], "could": [1, 2, 3, 5], "find": [1, 2, 3], "infect": 1, "machin": [1, 5], "q7": [1, 3], "would": [1, 2], "you": [1, 2, 3, 4, 5], "guess": 1, "purpos": [1, 2, 4, 5], "analyz": [1, 2, 3, 4, 5], "02": [1, 2, 4, 5], "definit": 1, "unpack": 1, "possibl": 1, "program": [1, 2, 3, 4, 5], "": [1, 2, 3, 4, 5], "function": [1, 3, 4, 5], "tell": 1, "host": [1, 2, 4, 5], "identifi": [1, 2, 3], "03": [1, 2, 4, 5], "04": [1, 2, 4], "wa": [1, 3], "ha": [1, 3, 4], "one": [1, 3, 4, 5], "resourc": 1, "section": 1, "hacker": 1, "examin": 1, "extract": 1, "can": [1, 2, 3, 4, 5], "learn": [1, 3], "from": [1, 2, 3, 4], "sun": 1, "dec": 1, "19": 1, "18": 1, "16": 1, "2010": 1, "38": 1, "peid": 1, "moreov": 1, "both": [1, 5], "decent": 1, "number": [1, 3], "psstudio": 1, "check": [1, 3, 4, 5], "show": 1, "creat": [1, 2, 3, 4, 5], "ws2_32": 1, "socket": [1, 3], "mean": 1, "we": [1, 2, 3, 4, 5], "need": [1, 3, 5], "investig": 1, "traffic": [1, 2, 3], "also": [1, 3], "createprocess": 1, "kernel32": [1, 2], "new": [1, 4], "process": [1, 2, 3, 5], "spawn": 1, "ye": [1, 4], "findfirstfil": 1, "findnextfil": 1, "u": [1, 3], "somefil": 1, "modifi": 1, "run": [1, 2, 3, 4, 5], "string": [1, 2, 3, 4, 5], "give": [1, 3], "some": [1, 2, 3], "useful": 1, "like": [1, 2, 3, 4], "ip": [1, 5], "127": [1, 5], "26": 1, "152": 1, "13": [1, 3], "watch": [1, 3], "come": 1, "kerne132": 1, "l": 1, "should": [1, 3, 4, 5], "notic": [1, 2, 3], "sleep": [1, 3, 4], "exec": 1, "mai": [1, 3, 5], "its": [1, 3, 5], "an": [1, 3], "agent": [1, 4, 5], "connect": [1, 2, 4, 5], "c": [1, 3, 4], "server": 1, "trojan": 1, "against": 1, "upx": 1, "bash": [], "d": [1, 4], "code": [3, 4], "block": [], "createservic": 1, "startservic": [1, 5], "start": [1, 2, 3, 4, 5], "servic": [1, 5], "internetopenurl": 1, "internetopen": 1, "open": [1, 3, 5], "specifi": [1, 3], "complet": 1, "ftp": 1, "url": [1, 4, 5], "getmodulefilenam": 1, "obtain": [1, 5], "fulli": 1, "qualifi": 1, "name": [1, 2, 3, 5], "given": 1, "handl": [1, 5], "see": [1, 3, 4, 5], "internet": [1, 4, 5], "explor": [1, 2, 4, 5], "malwareanalysisbook": [1, 5], "8": [1, 5], "0": [1, 3], "64": 1, "av": 1, "fsg": 1, "dulek": [], "look": [1, 3], "manual": 1, "onli": [1, 2, 3, 4, 5], "loadlibrari": 1, "getprocaddress": 1, "t": [1, 2, 3, 5], "63": 1, "No": 1, "malform": 1, "virtuals": 1, "close": 1, "rawsiz": 1, "sat": 1, "aug": 1, "31": 1, "00": 1, "59": 1, "2019": 1, "It": [1, 2, 3, 4, 5], "lookup": 1, "privileg": 1, "adjust": 1, "token": 1, "control": [1, 5], "most": [1, 2, 3, 4], "wupdmgrd": 1, "download": 1, "thepracticalmalwareanalysi": 1, "updat": 1, "There": [1, 3, 4], "binari": 1, "rsrc": 1, "urldownloadtofil": 1, "first": [2, 3, 4], "my": 2, "setup": [2, 5], "two": [2, 4, 5], "vm": [2, 3], "win7": 2, "linux": 2, "togeth": 2, "vmnet": [], "inetsim": 2, "On": 2, "procmon": 2, "set": [2, 3, 4, 5], "filter": 2, "execut": [2, 3, 4, 5], "clear": 2, "out": [2, 3, 4], "all": [2, 3], "event": 2, "just": 2, "befor": [2, 3, 4], "gather": [2, 3], "snapshot": [2, 3, 5], "registri": [2, 4], "regshot": 2, "up": [2, 3], "log": 2, "wireshark": 2, "apatedn": 2, "point": 2, "found": [2, 3, 4, 5], "lab03": 2, "basic": 2, "dynam": [2, 5], "how": [2, 3, 4, 5], "get": [2, 3, 5], "instal": [2, 3, 5], "itself": 2, "after": [2, 3, 4, 5], "under": 2, "order": [2, 5], "glean": 2, "while": 2, "monitor": 2, "safe": 2, "environ": 2, "live": 2, "memori": 2, "modif": 2, "further": [2, 3], "9": [2, 3], "happen": [2, 3], "caus": [2, 5], "roadblock": 2, "other": [2, 3, 4, 5], "wai": [2, 5], "pebear": 2, "exitprocess": 2, "dl": 2, "command": [2, 4, 5], "mani": [2, 3], "domain": 2, "intern": 2, "driver": 2, "By": [2, 3, 5], "utilt": 2, "rundll32": 2, "sc": [2, 5], "parent": 2, "pid": 2, "delet": [2, 4], "processcr": 2, "call": [2, 3, 4, 5], "cmd": [2, 3], "requir": 2, "certain": [2, 5], "condit": [2, 4], "line": [2, 3], "argument": [2, 3, 4], "don": 2, "know": [2, 5], "stage": 2, "util": [3, 5], "ida": 3, "lab05": 3, "pro": 3, "The": [3, 4], "goal": [3, 4], "hand": 3, "experi": 3, "ve": [3, 4, 5], "alreadi": 3, "work": [3, 4], "choos": 3, "ignor": 3, "focu": [3, 5], "revers": 3, "engin": 3, "5": [0, 4], "address": [3, 4, 5], "dllmain": 3, "window": [3, 4], "brows": 3, "gethostbynam": 3, "where": 3, "locat": [3, 4], "focus": 3, "0x10001757": 3, "figur": 3, "dn": 3, "request": 3, "made": [3, 4], "local": [3, 5], "variabl": 3, "recogn": [3, 4], "subroutin": [3, 4], "0x10001656": 3, "6": [0, 3], "paramet": [3, 4], "7": 0, "disassembli": 3, "area": 3, "refer": 3, "In": [3, 4, 5], "same": [3, 4, 5], "0x100101c8": 3, "dword_1008e5c4": 3, "global": 3, "help": [3, 4], "decid": 3, "path": 3, "take": [3, 4], "cross": 3, "10": [], "A": [3, 4, 5], "few": 3, "hundr": 3, "0x1000ff58": 3, "seri": 3, "comparison": 3, "memcmp": 3, "compar": [3, 4], "robotwork": 3, "success": [3, 4], "return": [3, 4], "11": [], "export": 3, "pslist": 3, "12": [], "graph": 3, "mode": 3, "sub_10004e79": 3, "api": 3, "enter": 3, "alon": 3, "renam": 3, "directli": 3, "depth": 3, "14": [], "At": [3, 5], "0x10001358": 3, "contain": [3, 4], "millisecond": 3, "backward": 3, "through": [3, 4], "long": [3, 4], "15": [], "0x10001701": 3, "three": 3, "q8": 3, "q9": 3, "q10": 3, "q11": 3, "q12": 3, "q13": 3, "q14": 3, "q15": 3, "load": 3, "direct": 3, "1000d02e": 3, "referenc": 3, "100163cc": 3, "xref": 3, "press": 3, "x": 3, "idata": 3, "time": [3, 4, 5], "uniqu": 3, "method": [3, 4, 5], "g": 3, "jump": [3, 4], "scroll": 3, "push": [3, 4], "eax": [3, 4], "data": 3, "ad": [3, 4, 5], "0x0d": 3, "decim": 3, "go": [3, 4, 5], "click": 3, "twice": 3, "undefin": 3, "place": 3, "redefin": 3, "offset": [3, 5], "pic": 3, "praticalmalwareanalysi": 3, "24": 3, "pass": [3, 4, 5], "posit": 3, "valu": 3, "respect": 3, "ebp": 3, "neg": 3, "lpthreadparamet": 3, "100101d0": 3, "hi": 3, "master": 3, "remot": [3, 5], "shell": 3, "sound": 3, "session": 3, "1001009d": 3, "doubl": 3, "mov": 3, "begin": [3, 5], "initi": 3, "stack": 3, "alloc": 3, "space": 3, "Then": [3, 4, 5], "structur": 3, "versioninform": 3, "pointer": 3, "getversionexa": 3, "zero": 3, "dwplatformid": 3, "equal": 3, "true": 3, "fals": 3, "al": [3, 4], "regist": [3, 5], "result": 3, "overal": [3, 4], "o": [3, 4], "win32nt": 3, "act": 3, "text": 3, "test": 3, "jnz": [3, 4], "next": [3, 4], "instruct": [3, 4], "flow": 3, "sub_100052a2": 3, "routin": [3, 4], "type": [3, 4], "buffer": 3, "send": 3, "over": 3, "try": [3, 4], "registeri": 3, "softwar": [3, 4, 5], "microsoft": [3, 4], "currentvers": [3, 4], "regopenkeyexa": 3, "jz": [3, 4], "loc_10005309": 3, "10005322": 3, "queri": 3, "worktim": 3, "sent": 3, "vaiabl": 3, "dword_1008e5bc": 3, "sub_100036c3": 3, "cmp": [3, 4], "majorvers": 3, "jb": 3, "short": 3, "loc_100036fa": 3, "version": [3, 5], "less": 3, "than": [3, 5], "cf": 3, "goe": 3, "piec": [3, 4], "str": 3, "isnot": 3, "null": 3, "empti": 3, "strlen": 3, "zf": 3, "taken": [3, 5], "non": 3, "1000664c": 3, "10006518": 3, "createtoolhelp32snapshot": 3, "well": 3, "heap": 3, "thread": [3, 5], "processentry32": 3, "put": [3, 4], "loop": [3, 4, 5], "pe": 3, "szexefil": 3, "those": [3, 4], "branch": 3, "seem": 3, "without": [3, 5], "langaug": 3, "getsystemlanguageid": 3, "sprintf": 3, "sub_100038e": 3, "send_languageid": 3, "For": [3, 5], "win": 3, "lot": 3, "10019020": 3, "cti": 3, "30": 3, "move": 3, "add": 3, "convert": 3, "int": 3, "multipli": 3, "1000": 3, "second": [3, 4], "protocol": 3, "af": 3, "q16": 3, "msdn": 3, "symbol": 3, "constant": 3, "make": [3, 5], "more": [3, 4, 5], "meaning": 3, "appli": 3, "chang": [3, 5], "q17": 3, "usag": 3, "opcod": 3, "0xed": 3, "magic": 3, "vmxh": 3, "perform": [3, 4], "vmware": 3, "detect": [3, 5], "evid": 3, "q18": 3, "your": [3, 5], "cursor": 3, "0x1001d988": 3, "q19": 3, "have": 3, "python": 3, "plug": 3, "includ": 3, "commerci": 3, "py": 3, "script": 3, "provid": 3, "book": 3, "sure": 3, "q20": 3, "With": 3, "turn": 3, "singl": [3, 4], "ascii": [3, 4], "q21": 3, "editor": 3, "_target": 3, "en": 3, "win32": 3, "winsock2": 3, "nf": 3, "right": 3, "alt": 3, "b": [3, 4], "byte": [3, 4], "occur": 3, "sub_10006196": 3, "hex": 3, "cancel": 3, "charact": 3, "outdat": 3, "xor": 3, "0x55": 3, "default": [3, 4], "format": [3, 4], "current": [3, 4], "select": 3, "screen": 3, "0x50": 3, "understand": 4, "construct": 4, "each": 4, "guid": 4, "discov": 4, "build": 4, "previou": [4, 5], "thu": 4, "complic": 4, "four": 4, "onc": [4, 5], "finish": [4, 5], "abl": 4, "easili": 4, "individu": 4, "encount": 4, "them": 4, "lab06": 4, "major": 4, "main": [4, 5], "print": 4, "state": 4, "output": 4, "0x40105f": 4, "oper": 4, "0x40117f": 4, "ll": [4, 5], "differ": 4, "between": 4, "been": 4, "pars": 4, "html": [4, 5], "assum": 4, "abov": [], "stream": 4, "fail": 4, "printf": 4, "here": 4, "tri": 4, "openurl": 4, "practicalmalwareanalysi": 4, "v7": 4, "depend": 4, "continu": [4, 5], "internetreadfil": 4, "read": 4, "200": 4, "readfil": 4, "bye": 4, "0x3c": 4, "receiv": 4, "combin": [4, 5], "bunch": 4, "switch": 4, "case": 4, "user": [4, 5], "As": 4, "summari": 4, "pma": 4, "cc": 4, "htm": 4, "401130": 4, "lpexistingfil": 4, "char": 4, "argv": 4, "arrai": 4, "lower": 4, "401040": [4, 5], "input": 4, "directori": [4, 5], "temp": 4, "copi": 4, "kei": 4, "persist": [4, 5], "startup": [4, 5], "e": 4, "100": 4, "error": 4, "multipl": 4, "thing": 4, "retriev": 4, "site": [4, 5], "1440": 4, "counter": 4, "var_c": 4, "parser": 4, "throughtout": 4, "dai": 4, "interv": 4, "lab07": 5, "ensur": 5, "achiev": 5, "comput": 5, "restart": 5, "why": 5, "mutex": 5, "good": 5, "malici": 5, "prior": 5, "note": 5, "becaus": 5, "might": 5, "victim": 5, "visibl": 5, "loopback": 5, "real": 5, "localhost": 5, "protect": 5, "warn": 5, "consider": 5, "damag": 5, "difficult": 5, "remov": 5, "virtual": 5, "bit": 5, "challeng": 5, "ones": 5, "static": 5, "big": 5, "pictur": 5, "avoid": 5, "bog": 5, "down": 5, "detail": 5, "Into": 5, "startservicectrldispatchera": 5, "manag": 5, "instanc": 5, "startyp": 5, "autostart": 5, "pc": 5, "To": 5, "hardcod": 5, "must": 5, "consist": 5, "aren": 5, "commun": 5, "qc": 5, "malservic": 5, "hgl345": 5, "waitforsingleobject": 5, "waitabl": 5, "timer": 5, "wait": 5, "2100": 5, "834h": 5, "4010de": 5, "reach": 5, "year": 5, "20": 5, "zombi": 5, "botnet": 5, "infinit": 5, "never": 5, "object": 5, "oleiniti": 5, "cocreateinst": 5, "our": 5, "hkey_local_machin": 5, "class": 5, "clsid": 5, "2df01": 5, "mayb": 5, "adwar": 5, "now": 5, "eplor": 5, "uninti": 5, "normal": 5}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 0, "abdelrahmn": 0, "walkthrough": 0, "": [], "document": [], "indic": 0, "tabl": 0, "practic": [1, 2, 3, 4, 5], "malwar": [1, 2, 3, 4, 5], "analysi": [1, 2, 3, 4, 5], "lab": [1, 2, 3, 4, 5], "1": [1, 2, 3, 4, 5], "2": [1, 2, 4, 5], "3": [1, 2, 4, 5], "4": [1, 2, 4], "5": 3, "6": 4, "7": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Practical Malware Analysis - Lab 1": [[1, "practical-malware-analysis-lab-1"]], "Lab 1-1": [[1, "lab-1-1"]], "Lab 1-2": [[1, "lab-1-2"]], "Lab 1-3": [[1, "lab-1-3"]], "Lab 1-4": [[1, "lab-1-4"]], "Practical Malware Analysis - Lab 3": [[2, "practical-malware-analysis-lab-3"]], "Lab 3-1": [[2, "lab-3-1"]], "Lab 3-2": [[2, "lab-3-2"]], "Lab 3-3": [[2, "lab-3-3"]], "Lab 3-4": [[2, "lab-3-4"]], "Practical Malware Analysis - Lab 5": [[3, "practical-malware-analysis-lab-5"]], "Lab 5-1": [[3, "lab-5-1"]], "Practical Malware Analysis - Lab 6": [[4, "practical-malware-analysis-lab-6"]], "Lab 6-1": [[4, "lab-6-1"]], "Lab 6-2": [[4, "lab-6-2"]], "Lab 6-3": [[4, "lab-6-3"]], "Lab 6-4": [[4, "lab-6-4"]], "Welcome to abdelrahmn walkthrough!": [[0, "welcome-to-abdelrahmn-walkthrough"]], "Indices and tables": [[0, "indices-and-tables"]], "Practical Malware Analysis - Lab 7": [[5, "practical-malware-analysis-lab-7"]], "Lab 7-1": [[5, "lab-7-1"]], "Lab 7-2": [[5, "lab-7-2"]], "Lab 7-3": [[5, "lab-7-3"]]}, "indexentries": {}})