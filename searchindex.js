Search.setIndex({"docnames": ["index", "lab1/lab1", "lab10/lab10", "lab11/lab11", "lab12/lab12", "lab13/lab13", "lab14/lab14", "lab15/lab15", "lab16/lab16", "lab17/lab17", "lab18/lab18", "lab19/lab19", "lab3/lab3", "lab5/lab5", "lab6/lab6", "lab7/lab7", "lab9/lab9", "mal1/mal1"], "filenames": ["index.rst", "lab1\\lab1.rst", "lab10\\lab10.rst", "lab11\\lab11.rst", "lab12\\lab12.rst", "lab13\\lab13.rst", "lab14\\lab14.rst", "lab15\\lab15.rst", "lab16\\lab16.rst", "lab17\\lab17.rst", "lab18\\lab18.rst", "lab19\\lab19.rst", "lab3\\lab3.rst", "lab5\\lab5.rst", "lab6\\lab6.rst", "lab7\\lab7.rst", "lab9\\lab9.rst", "mal1\\mal1.rst"], "titles": ["Welcome to my PMA walkthrough!", "Practical Malware Analysis - Lab 1", "Practical Malware Analysis - Lab 10", "Practical Malware Analysis - Lab 11", "Practical Malware Analysis - Lab 12", "Practical Malware Analysis - Lab 13", "Practical Malware Analysis - Lab 14", "Practical Malware Analysis - Lab 15", "Practical Malware Analysis - Lab 16", "Practical Malware Analysis - Lab 17", "Practical Malware Analysis - Lab 18", "Practical Malware Analysis - Lab 19", "Practical Malware Analysis - Lab 3", "Practical Malware Analysis - Lab 5", "Practical Malware Analysis - Lab 6", "Practical Malware Analysis - Lab 7", "Practical Malware Analysis - Lab 9", "Princess Locker"], "terms": {"index": [0, 5, 6], "modul": [0, 1, 3, 4, 7, 13], "search": [0, 1, 3, 4, 5, 6, 8, 9, 10, 12, 13, 15, 16, 17], "page": [0, 5, 7, 13], "practic": 0, "malwar": 0, "analysi": 0, "lab": 0, "1": [0, 17], "thi": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "us": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "file": [1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17], "lab01": 1, "01": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "ex": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "dll": [1, 3, 4, 5, 6, 9, 12, 13, 15, 16, 17], "tool": [1, 5, 7, 9, 12], "techniqu": [1, 3, 5, 6, 7, 8, 9, 10, 16], "describ": 1, "chapter": [1, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16], "gain": 1, "inform": [1, 5, 6, 7, 9, 10, 12, 13, 17], "about": [1, 3, 6, 8, 13], "answer": [1, 3, 4, 5, 7, 9, 16], "question": [1, 5, 7, 9, 13, 14, 16], "below": [1, 8], "q1": [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "upload": 1, "http": [1, 3, 4, 5, 6, 7, 8, 9, 13, 15, 16], "www": [1, 3, 4, 5, 6, 7, 9, 15, 16], "virustot": 1, "com": [1, 4, 5, 6, 7, 8, 13, 14, 15, 16], "view": [1, 3, 10, 13, 16], "report": 1, "doe": [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 13, 14, 15, 16], "either": [1, 9, 17], "match": [1, 7, 9, 13, 16, 17], "ani": [1, 2, 3, 5, 6, 9, 12, 13, 14, 15, 16], "exist": 1, "antiviru": 1, "signatur": [1, 6, 12, 15, 16], "45": 1, "vendor": 1, "flag": [1, 5, 7, 13], "suspici": [1, 3, 6], "55": 1, "imag": [3, 6], "1ex": [], "png": [3, 6], "2": [0, 13, 17], "3": [0, 8, 13, 17], "4": [0, 5, 6, 7, 8, 9, 11, 13, 16, 17], "q2": [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "when": [1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 16], "were": [1, 3, 15], "compil": 1, "q3": [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "ar": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "indic": [1, 5, 6, 7, 12, 14, 15, 16], "i": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "pack": [1, 10, 12], "obfusc": [1, 16], "If": [1, 2, 3, 5, 6, 8, 9, 12, 13, 14, 15, 17], "so": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "what": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "q4": [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "do": [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "import": [1, 3, 4, 5, 8, 9, 10, 11, 12, 13, 15, 16, 17], "hint": [1, 8, 13], "which": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "thei": [1, 2, 4, 6, 8, 9, 12, 13], "q5": [1, 3, 4, 5, 6, 8, 9, 11, 12, 13, 14, 15, 16], "q6": [1, 3, 4, 5, 6, 8, 9, 11, 12, 13, 14, 15, 16], "network": [1, 5, 6, 11, 12, 13, 14, 15, 16], "base": [1, 3, 4, 5, 12, 13, 14, 15, 16, 17], "could": [1, 4, 6, 9, 10, 12, 13, 15, 16], "find": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17], "infect": [1, 3, 6, 17], "machin": [1, 2, 3, 9, 15, 17], "q7": [1, 3, 5, 6, 8, 9, 13, 16], "would": [1, 3, 5, 6, 12], "you": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "guess": [1, 8], "purpos": [1, 3, 4, 6, 7, 8, 12, 14, 15, 16], "analyz": [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "02": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], "definit": 1, "unpack": [1, 10, 11, 17], "possibl": [1, 6, 8], "program": [1, 2, 4, 6, 7, 8, 11, 12, 13, 14, 15, 16, 17], "": [1, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 16, 17], "function": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17], "tell": 1, "host": [1, 2, 5, 6, 9, 11, 12, 14, 15, 16], "identifi": [1, 4, 5, 6, 10, 12, 13, 16, 17], "03": [0, 1, 2, 3, 4, 5, 6, 7, 9, 12, 14, 15, 16], "04": [1, 4, 12, 14], "wa": [1, 2, 3, 5, 6, 9, 10, 13, 16, 17], "ha": [1, 4, 5, 6, 9, 10, 13, 14, 16, 17], "one": [1, 3, 4, 5, 6, 7, 9, 10, 13, 14, 15, 16], "resourc": [1, 3, 4, 5, 6], "section": [1, 4, 5, 6, 10, 17], "hacker": 1, "examin": [1, 2, 3], "extract": [1, 3, 4, 7], "can": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "learn": [1, 4, 6, 10, 13], "from": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17], "sun": 1, "dec": 1, "19": [0, 1], "18": [0, 1], "16": [0, 1, 3, 5, 9], "2010": 1, "38": 1, "peid": [1, 5, 10], "moreov": 1, "both": [1, 2, 3, 6, 15, 16, 17], "decent": [1, 17], "number": [1, 4, 8, 9, 13, 17], "psstudio": 1, "check": [1, 2, 3, 4, 5, 6, 7, 8, 9, 13, 14, 15, 16, 17], "show": [1, 10, 16, 17], "creat": [1, 2, 3, 4, 5, 6, 8, 9, 11, 12, 13, 14, 15, 16, 17], "ws2_32": 1, "socket": [1, 5, 13], "mean": [1, 2, 3, 4, 7], "we": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "need": [1, 2, 3, 5, 6, 8, 10, 13, 15, 16, 17], "investig": 1, "traffic": [1, 5, 12, 13], "also": [1, 3, 4, 5, 6, 7, 8, 10, 13, 17], "createprocess": [1, 5], "kernel32": [1, 12, 15, 16], "new": [1, 3, 5, 6, 14], "process": [1, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 15, 16], "spawn": [1, 5], "ye": [1, 10, 14], "findfirstfil": [1, 17], "findnextfil": [1, 17], "u": [1, 4, 6, 13], "somefil": 1, "modifi": [1, 3, 4, 5], "run": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "string": [1, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 16, 17], "give": [1, 13, 17], "some": [1, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17], "useful": 1, "like": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "ip": [1, 6, 15], "127": [1, 15], "26": [1, 15], "152": [1, 15], "13": [0, 1, 4, 6, 13, 15], "watch": [1, 5, 13], "come": [1, 6], "kerne132": [1, 15], "l": [1, 16], "should": [1, 3, 6, 8, 9, 10, 13, 14, 15], "notic": [1, 3, 4, 5, 7, 8, 10, 12, 13, 15, 16, 17], "sleep": [1, 3, 5, 13, 14], "exec": 1, "mai": [1, 3, 5, 6, 8, 10, 13, 15, 16, 17], "its": [1, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16], "an": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 13, 16], "agent": [1, 6, 7, 14, 15], "connect": [1, 5, 12, 14, 15], "c": [1, 2, 3, 5, 6, 7, 11, 13, 14, 15, 16, 17], "server": [1, 6], "trojan": 1, "against": [1, 8, 9], "upx": [1, 10], "bash": [], "d": [1, 7, 10, 14], "code": [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17], "block": 5, "createservic": 1, "startservic": [1, 15], "start": [1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 16, 17], "servic": [1, 2, 9, 15, 16], "internetopenurl": 1, "internetopen": 1, "open": [1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 13, 15, 16, 17], "specifi": [1, 3, 4, 5, 6, 9, 11, 13, 16], "complet": [1, 3, 5], "ftp": 1, "url": [1, 5, 6, 7, 14, 15], "getmodulefilenam": 1, "obtain": [1, 6, 15], "fulli": 1, "qualifi": 1, "name": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 15, 16, 17], "given": [1, 6, 11], "handl": [1, 3, 4, 5, 7, 8, 9, 15], "see": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17], "internet": [1, 5, 6, 14, 15, 17], "explor": [1, 4, 6, 12, 14, 15], "malwareanalysisbook": [1, 15], "8": [1, 5, 6, 15, 17], "0": [1, 4, 5, 6, 8, 9, 10, 11, 13], "64": [1, 5], "av": 1, "fsg": [1, 10], "dulek": [], "look": [1, 3, 4, 5, 6, 7, 9, 10, 13, 16, 17], "manual": [1, 8, 10, 11], "onli": [1, 4, 5, 6, 7, 8, 12, 13, 14, 15, 17], "loadlibrari": [1, 4, 17], "getprocaddress": [1, 3, 10], "t": [1, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17], "63": 1, "No": [1, 8], "malform": 1, "virtuals": 1, "close": [1, 17], "rawsiz": 1, "sat": 1, "aug": 1, "31": [1, 16], "00": 1, "59": 1, "2019": 1, "It": [1, 3, 4, 5, 6, 7, 9, 10, 12, 13, 14, 15, 16, 17], "lookup": 1, "privileg": [1, 3, 9, 11], "adjust": 1, "token": 1, "control": [1, 6, 9, 15], "most": [1, 3, 12, 13, 14], "wupdmgrd": 1, "download": [1, 5, 6, 7, 10], "thepracticalmalwareanalysi": 1, "updat": [1, 3, 4], "There": [1, 7, 13, 14], "binari": [1, 3, 5, 7, 8, 9, 11, 16, 17], "rsrc": [1, 3, 4, 5, 6, 17], "urldownloadtofil": 1, "first": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "my": [3, 5, 6, 9, 12], "setup": [12, 15], "two": [4, 5, 6, 7, 8, 9, 12, 14, 15], "vm": [9, 12, 13], "win7": 12, "linux": 12, "togeth": [5, 12], "vmnet": [], "inetsim": 12, "On": [4, 12], "procmon": [2, 3, 4, 5, 9, 12, 16], "set": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "filter": [2, 12], "execut": [2, 3, 4, 5, 7, 8, 9, 12, 13, 14, 15, 16, 17], "clear": [3, 12], "out": [3, 6, 8, 9, 10, 12, 13, 14, 16, 17], "all": [3, 4, 5, 6, 7, 8, 9, 12, 13, 15, 16, 17], "event": [4, 12], "just": [3, 4, 5, 7, 8, 9, 10, 12, 17], "befor": [5, 7, 10, 12, 13, 14, 17], "gather": [4, 5, 12, 13], "snapshot": [3, 12, 13, 15], "registri": [2, 3, 11, 12, 14], "regshot": 12, "up": [4, 6, 7, 12, 13], "log": [3, 4, 9, 12], "wireshark": [3, 12], "apatedn": 12, "point": [3, 4, 9, 10, 11, 12], "found": [2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17], "lab03": 12, "basic": [3, 12, 16], "dynam": [3, 5, 6, 11, 12, 15, 16], "how": [2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], "get": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17], "instal": [3, 4, 9, 12, 13, 15, 16], "itself": [4, 6, 7, 12, 16], "after": [2, 3, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17], "under": [3, 9, 12, 15, 16, 17], "order": [2, 3, 6, 7, 8, 12, 15], "glean": 12, "while": [4, 6, 10, 11, 12, 16], "monitor": [3, 9, 12], "safe": [8, 11, 12], "environ": [3, 4, 12], "live": 12, "memori": [2, 3, 4, 5, 7, 8, 9, 10, 12, 15, 16, 17], "modif": [8, 12], "further": [10, 12, 13], "9": [0, 6, 8, 12, 13, 17], "happen": [3, 4, 8, 9, 12, 13, 16, 17], "caus": [6, 7, 8, 12, 15], "roadblock": 12, "other": [5, 7, 9, 10, 12, 13, 14, 15], "wai": [3, 7, 12, 15], "pebear": [12, 17], "exitprocess": 12, "dl": [11, 12], "command": [4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16], "mani": [3, 7, 9, 12, 13, 16], "domain": [6, 8, 12, 16], "intern": 12, "driver": [2, 12], "By": [4, 12, 13, 15, 16], "utilt": 12, "rundll32": [3, 9, 12], "sc": [12, 15], "parent": 12, "pid": [4, 9, 11, 12], "delet": [6, 8, 9, 12, 14, 16], "processcr": 12, "call": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "cmd": [3, 4, 5, 12, 13, 16], "requir": [4, 12, 16], "certain": [3, 8, 12, 15], "condit": [3, 6, 7, 8, 9, 12, 14, 16, 17], "line": [6, 7, 8, 9, 12, 13, 16], "argument": [2, 3, 4, 6, 7, 9, 11, 12, 13, 14, 16], "don": [4, 12, 17], "know": [2, 5, 6, 8, 12, 15, 17], "stage": 12, "util": [11, 13, 15, 16], "ida": [2, 3, 4, 5, 7, 8, 9, 10, 11, 13, 16, 17], "lab05": 13, "pro": [5, 8, 9, 13, 16], "The": [2, 3, 5, 6, 8, 9, 10, 11, 13, 14, 16, 17], "goal": [8, 10, 13, 14], "hand": 13, "experi": 13, "ve": [5, 11, 13, 14, 15], "alreadi": [2, 13, 17], "work": [2, 3, 8, 9, 10, 13, 14], "choos": [6, 13], "ignor": 13, "focu": [6, 7, 8, 9, 13, 15], "revers": [5, 6, 13, 15], "engin": 13, "5": [0, 3, 6, 7, 8, 9, 14, 17], "address": [3, 4, 6, 9, 10, 11, 13, 14, 15, 16, 17], "dllmain": [3, 13, 15], "window": [2, 3, 4, 5, 6, 8, 13, 14, 15, 17], "brows": 13, "gethostbynam": 13, "where": [2, 3, 4, 5, 6, 8, 10, 11, 13, 16], "locat": [3, 4, 6, 7, 8, 9, 10, 11, 13, 14, 16], "focus": [5, 8, 13], "0x10001757": 13, "figur": [8, 13], "dn": [6, 13], "request": [5, 6, 7, 13, 16], "made": [13, 14, 17], "local": [4, 6, 7, 9, 13, 15, 17], "variabl": [4, 5, 6, 9, 13], "recogn": [13, 14], "subroutin": [13, 14, 15, 16], "0x10001656": 13, "6": [0, 6, 8, 13, 16, 17], "paramet": [3, 4, 5, 6, 8, 9, 11, 13, 14, 16, 17], "7": [0, 3, 8, 9, 17], "disassembli": [5, 7, 13], "area": [5, 6, 13], "refer": [3, 5, 6, 7, 13], "In": [4, 5, 8, 10, 11, 13, 14, 15, 16], "same": [2, 3, 4, 5, 6, 8, 9, 10, 13, 14, 15, 16], "0x100101c8": 13, "dword_1008e5c4": 13, "global": [4, 9, 13], "help": [3, 6, 10, 13, 14], "decid": [8, 13], "path": [3, 5, 6, 13, 16, 17], "take": [3, 5, 7, 8, 10, 13, 14, 16, 17], "cross": [3, 4, 5, 6, 7, 13], "10": [0, 8, 17], "A": [5, 6, 9, 11, 13, 14, 15], "few": [10, 13], "hundr": 13, "0x1000ff58": 13, "seri": [9, 13], "comparison": [5, 9, 13], "memcmp": [3, 13], "compar": [3, 4, 5, 9, 13, 14, 16], "robotwork": 13, "success": [2, 5, 8, 9, 10, 13, 14, 15], "return": [2, 3, 4, 5, 7, 8, 9, 10, 11, 13, 14, 16, 17], "11": [0, 17], "export": [3, 7, 9, 13], "pslist": 13, "12": [0, 5, 10], "graph": [10, 13], "mode": [3, 5, 9, 13], "sub_10004e79": 13, "api": [6, 13], "enter": 13, "alon": [6, 13], "renam": [5, 8, 13, 16], "directli": [4, 5, 11, 13], "depth": [6, 13], "14": 0, "At": [6, 7, 13, 15], "0x10001358": 13, "contain": [3, 4, 5, 6, 7, 9, 11, 13, 14, 15], "millisecond": 13, "backward": [9, 10, 13], "through": [5, 8, 10, 13, 14, 15], "long": [6, 13, 14], "15": 0, "0x10001701": 13, "three": [3, 5, 13, 16], "q8": [3, 5, 6, 8, 13, 16], "q9": [3, 5, 6, 8, 13], "q10": 13, "q11": [8, 13], "q12": 13, "q13": 13, "q14": 13, "q15": 13, "load": [3, 4, 5, 6, 8, 9, 11, 13, 16, 17], "direct": [2, 6, 13], "1000d02e": 13, "referenc": 13, "100163cc": 13, "xref": [7, 9, 13], "press": [3, 4, 7, 11, 13], "x": [13, 17], "idata": 13, "time": [3, 5, 7, 8, 9, 10, 13, 14, 15], "uniqu": [8, 13], "method": [5, 9, 13, 14, 15], "g": 13, "jump": [3, 7, 8, 9, 10, 13, 14], "scroll": 13, "push": [5, 6, 8, 9, 10, 11, 13, 14, 17], "eax": [2, 3, 8, 9, 10, 11, 13, 14, 16, 17], "data": [3, 5, 6, 7, 10, 11, 13, 15, 16, 17], "ad": [8, 9, 10, 13, 14, 15], "0x0d": 13, "decim": [11, 13], "go": [2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17], "click": [8, 10, 13], "twice": 13, "undefin": [3, 11, 13], "place": [2, 3, 4, 7, 8, 10, 13, 17], "redefin": 13, "offset": [3, 8, 11, 13, 15], "pic": 13, "praticalmalwareanalysi": 13, "24": 13, "pass": [3, 4, 5, 6, 7, 8, 9, 13, 14, 15, 16], "posit": 13, "valu": [3, 5, 8, 9, 11, 13, 16, 17], "respect": 13, "ebp": [3, 5, 10, 13], "neg": 13, "lpthreadparamet": 13, "100101d0": 13, "hi": [6, 13], "master": [10, 13], "remot": [4, 13, 15, 17], "shell": [5, 6, 13], "sound": [3, 5, 6, 13], "session": 13, "1001009d": 13, "doubl": 13, "mov": [13, 16], "begin": [13, 15], "initi": [4, 5, 6, 7, 13, 16], "stack": [5, 7, 8, 10, 11, 13, 16, 17], "alloc": [3, 4, 5, 13], "space": [2, 3, 4, 13], "Then": [2, 4, 7, 9, 10, 11, 13, 14, 15, 17], "structur": [3, 5, 8, 13], "versioninform": 13, "pointer": [4, 7, 13], "getversionexa": 13, "zero": [2, 3, 4, 5, 7, 8, 9, 10, 13, 17], "dwplatformid": 13, "equal": [4, 9, 13, 16, 17], "true": [5, 13], "fals": [7, 13, 17], "al": [9, 11, 13, 14], "regist": [4, 9, 13, 15, 16], "result": [2, 3, 7, 9, 13], "overal": [6, 13, 14], "o": [5, 6, 9, 13, 14, 17], "win32nt": 13, "act": 13, "text": [13, 17], "test": [3, 10, 13, 16], "jnz": [7, 13, 14], "next": [4, 8, 9, 10, 11, 13, 14], "instruct": [3, 5, 7, 9, 10, 11, 13, 14, 16], "flow": [3, 4, 8, 13, 16, 17], "sub_100052a2": 13, "routin": [3, 4, 5, 6, 7, 8, 9, 11, 13, 14, 16, 17], "type": [2, 3, 4, 5, 6, 8, 9, 10, 13, 14], "buffer": [3, 4, 5, 6, 13], "send": [3, 5, 6, 7, 13, 15], "over": [3, 4, 5, 6, 10, 11, 13, 16, 17], "try": [6, 7, 8, 9, 10, 13, 14, 17], "registeri": [9, 11, 13], "softwar": [3, 13, 14, 15], "microsoft": [3, 4, 6, 13, 14, 17], "currentvers": [3, 13, 14], "regopenkeyexa": 13, "jz": [7, 13, 14], "loc_10005309": 13, "10005322": 13, "queri": [5, 11, 13, 16], "worktim": 13, "sent": [3, 4, 5, 13], "vaiabl": 13, "dword_1008e5bc": 13, "sub_100036c3": 13, "cmp": [9, 10, 13, 14], "majorvers": 13, "jb": 13, "short": 13, "loc_100036fa": 13, "version": [9, 10, 13, 15], "less": [5, 10, 13], "than": [5, 6, 7, 8, 10, 13, 15], "cf": 13, "goe": [9, 13], "piec": [11, 13, 14, 16], "str": [5, 6, 9, 13], "isnot": 13, "null": [5, 8, 13], "empti": [5, 13, 17], "strlen": 13, "zf": 13, "taken": [8, 9, 13, 15], "non": [2, 5, 13], "1000664c": 13, "10006518": 13, "createtoolhelp32snapshot": 13, "well": [3, 13], "heap": [3, 13], "thread": [3, 4, 5, 6, 7, 8, 13, 15], "processentry32": [3, 13], "put": [2, 3, 5, 6, 7, 8, 11, 13, 14, 16, 17], "loop": [3, 4, 5, 6, 8, 11, 13, 14, 15, 16], "pe": [8, 13, 17], "szexefil": 13, "those": [3, 5, 6, 10, 13, 14], "branch": [4, 7, 8, 9, 13, 16], "seem": [3, 5, 6, 7, 8, 9, 13], "without": [5, 6, 8, 9, 13, 15], "langaug": 13, "getsystemlanguageid": 13, "sprintf": 13, "sub_100038e": 13, "send_languageid": 13, "For": [4, 5, 8, 10, 13, 15], "win": [3, 13], "lot": [3, 4, 5, 7, 8, 9, 13], "10019020": 13, "cti": 13, "30": [8, 13], "move": [8, 13, 16], "add": [3, 5, 6, 13, 17], "convert": [4, 7, 9, 13, 16, 17], "int": [5, 13], "multipli": 13, "1000": [8, 13, 17], "second": [3, 4, 5, 6, 8, 9, 13, 14, 16, 17], "protocol": [6, 13], "af": 13, "q16": 13, "msdn": [4, 13], "symbol": 13, "constant": [3, 5, 13], "make": [2, 3, 4, 6, 7, 8, 9, 13, 15, 16, 17], "more": [3, 6, 7, 8, 13, 14, 15], "meaning": 13, "appli": 13, "chang": [2, 3, 6, 8, 9, 13, 15, 17], "q17": 13, "usag": 13, "opcod": [3, 7, 11, 13], "0xed": 13, "magic": [5, 9, 13], "vmxh": [9, 13], "perform": [4, 6, 13, 14], "vmware": [9, 13], "detect": [6, 9, 13, 15], "evid": 13, "q18": 13, "your": [3, 5, 6, 9, 10, 11, 13, 15], "cursor": 13, "0x1001d988": 13, "q19": 13, "have": [2, 3, 6, 8, 9, 11, 13, 17], "python": [5, 9, 13], "plug": [8, 13], "includ": [2, 8, 13, 16], "commerci": [9, 13], "py": [9, 13], "script": [5, 9, 13], "provid": [3, 6, 9, 13, 16], "book": [5, 7, 13], "sure": [3, 4, 8, 13, 17], "q20": 13, "With": [6, 13], "turn": 13, "singl": [4, 5, 8, 13, 14], "ascii": [13, 14, 16], "q21": 13, "editor": [5, 13], "_target": 13, "en": [4, 6, 13], "win32": [4, 6, 13], "winsock2": 13, "nf": [6, 13], "right": [3, 8, 9, 13], "alt": 13, "b": [5, 13, 14], "byte": [3, 4, 5, 6, 7, 8, 11, 13, 14], "occur": 13, "sub_10006196": 13, "hex": [5, 7, 9, 11, 13, 16, 17], "cancel": 13, "charact": [3, 4, 5, 6, 7, 13], "outdat": 13, "xor": [4, 5, 11, 13, 16], "0x55": 13, "default": [5, 8, 11, 13, 14, 17], "format": [3, 13, 14], "current": [3, 6, 13, 14], "select": 13, "screen": 13, "0x50": 13, "understand": [8, 14], "construct": [6, 14], "each": [4, 5, 6, 7, 8, 9, 10, 14], "guid": 14, "discov": [3, 14], "build": [6, 14], "previou": [8, 9, 10, 14, 15], "thu": 14, "complic": 14, "four": 14, "onc": [2, 4, 10, 14, 15], "finish": [5, 10, 14, 15], "abl": [10, 14], "easili": [6, 10, 11, 14], "individu": 14, "encount": [10, 14], "them": [3, 5, 8, 9, 14, 17], "lab06": 14, "major": 14, "main": [3, 4, 5, 7, 8, 9, 14, 15, 16, 17], "print": [3, 7, 9, 11, 14, 16], "state": [4, 14], "output": [4, 5, 6, 7, 8, 14, 16, 17], "0x40105f": 14, "oper": [3, 4, 9, 14], "0x40117f": 14, "ll": [6, 11, 14, 15], "differ": [6, 8, 14, 16, 17], "between": [3, 6, 7, 8, 14, 17], "been": [6, 14], "pars": 14, "html": [4, 7, 14, 15], "assum": [3, 14], "abov": [3, 4, 5, 6, 7, 8, 9, 17], "stream": [5, 14], "fail": [2, 6, 8, 9, 10, 11, 14], "printf": 14, "here": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 16, 17], "tri": [5, 14], "openurl": [6, 14], "practicalmalwareanalysi": [4, 5, 6, 7, 14, 16], "v7": [3, 4, 5, 14], "depend": [6, 14], "continu": [3, 4, 14, 15, 17], "internetreadfil": 14, "read": [3, 5, 6, 7, 10, 14, 17], "200": 14, "readfil": 14, "bye": 14, "0x3c": 14, "receiv": [6, 14], "combin": [14, 15], "bunch": 14, "switch": 14, "case": [10, 14], "user": [2, 3, 5, 6, 7, 8, 9, 14, 15, 17], "As": [5, 6, 14, 16], "summari": [7, 14], "pma": 14, "cc": [14, 16], "htm": [3, 4, 14], "401130": 14, "lpexistingfil": 14, "char": [5, 7, 8, 14], "argv": [14, 16], "arrai": [5, 14, 17], "lower": [9, 14], "401040": [14, 15], "input": [3, 4, 5, 6, 7, 14], "directori": [2, 3, 4, 9, 14, 15, 17], "temp": 14, "copi": [3, 4, 5, 6, 9, 11, 14, 15, 17], "kei": [3, 4, 5, 11, 14, 16], "persist": [3, 9, 14, 15], "startup": [14, 15], "e": [3, 8, 14, 16], "100": [6, 14], "error": [7, 14, 17], "multipl": [3, 6, 14], "thing": [5, 6, 14], "retriev": [5, 6, 14], "site": [14, 15], "1440": 14, "counter": 14, "var_c": 14, "parser": 14, "throughtout": 14, "dai": [3, 14], "interv": 14, "lab07": [9, 10, 15], "ensur": [4, 9, 15], "achiev": [3, 6, 15], "comput": [2, 6, 7, 15], "restart": [4, 15], "why": [3, 6, 8, 9, 15], "mutex": [3, 15, 17], "good": [5, 6, 7, 15, 17], "malici": [4, 5, 7, 8, 15, 16], "prior": 15, "note": 15, "becaus": [2, 3, 6, 7, 8, 9, 11, 15], "might": [3, 5, 6, 15], "victim": [2, 4, 15], "visibl": 15, "loopback": [6, 15], "real": [11, 15], "localhost": 15, "protect": [3, 4, 5, 8, 15, 17], "warn": 15, "consider": 15, "damag": 15, "difficult": [6, 15], "remov": [5, 6, 15], "virtual": [9, 15, 17], "bit": [3, 9, 15, 17], "challeng": 15, "ones": 15, "static": [3, 5, 6, 8, 10, 15, 16], "big": 15, "pictur": 15, "avoid": [8, 9, 15, 16], "bog": 15, "down": 15, "detail": [9, 11, 15], "Into": [5, 8, 15], "startservicectrldispatchera": 15, "manag": [4, 6, 15, 16], "instanc": [8, 15], "startyp": 15, "autostart": 15, "pc": [5, 15], "To": [6, 15], "hardcod": 15, "must": [2, 3, 5, 6, 8, 9, 15], "consist": 15, "aren": 15, "commun": [6, 9, 11, 15], "qc": 15, "malservic": 15, "hgl345": 15, "waitforsingleobject": 15, "waitabl": 15, "timer": 15, "wait": [6, 9, 10, 15], "2100": [9, 15], "834h": 15, "4010de": 15, "reach": [9, 15, 16, 17], "year": [9, 15], "20": [3, 6, 15], "zombi": 15, "botnet": 15, "infinit": [5, 15], "never": 15, "object": [6, 15], "oleiniti": 15, "cocreateinst": 15, "our": [5, 6, 8, 10, 11, 15, 16, 17], "hkey_local_machin": 15, "class": 15, "clsid": 15, "2df01": 15, "mayb": [3, 4, 5, 7, 8, 9, 10, 15], "adwar": 15, "now": [3, 4, 5, 8, 15, 16, 17], "eplor": 15, "uninti": 15, "normal": [3, 6, 7, 8, 15], "ioc": 15, "system32": [2, 3, 4, 15, 16], "map": [3, 4, 5, 15], "reflect": 15, "disk": [3, 15, 17], "And": [6, 8, 15, 17], "132": 15, "l32": 15, "4011e0": [8, 15], "iter": [15, 17], "string2": 15, "replac": [3, 4, 5, 15, 17], "dword_403010": 15, "qmemcpi": 15, "ping": 15, "pong": 15, "reciev": [5, 15], "overwrit": [3, 15], "instead": [5, 6, 15], "sadfhuhf": 15, "inject": [3, 4, 9, 11, 15], "logic": [2, 15], "Or": [8, 15], "easier": [15, 16], "lab09": [8, 10, 16], "ollydbg": [3, 5, 8, 9, 10, 16], "follow": [4, 5, 6, 7, 8, 9, 10, 11, 16, 17], "option": [6, 8, 16], "password": [8, 16], "perman": [9, 16], "patch": [8, 9, 16], "doesn": [3, 6, 8, 9, 16], "special": [4, 16], "action": [6, 16], "via": [5, 6, 8, 11, 16], "sampl": [7, 8, 11, 16], "payload": [4, 8, 16], "0x00401133": 16, "being": [3, 4, 5, 7, 8, 9, 16], "0x00401089": 16, "encod": [4, 5, 6, 8, 11, 16], "signific": [3, 16], "createprocessa": 16, "0x0040106e": 16, "dll1": 16, "dll2": 16, "dll3": 16, "built": 16, "therefor": 16, "versu": 16, "appear": [7, 8, 10, 16], "comfort": 16, "correct": [7, 8, 16], "within": [4, 5, 6, 16], "debug": [3, 8, 10, 16], "assign": [9, 16], "writefil": [5, 16], "filenam": [3, 5, 7, 9, 16], "write": [3, 4, 5, 6, 9, 10, 16], "job": [7, 16], "netschedulejobadd": 16, "mysteri": 16, "sub_402410": 16, "del": 16, "respons": [3, 5, 6, 7, 16], "last": [6, 16], "argc": 16, "abcd": 16, "passkei": 16, "n": 16, "r": 16, "involv": 16, "around": [8, 10, 16], "re": 16, "opposit": 16, "suppli": [9, 16], "xp": [3, 8, 16], "subkei": [9, 16], "arugu": 16, "qw": 16, "402af0": 16, "step": [4, 8, 10, 16, 17], "till": [5, 10, 16, 17], "sinc": [5, 6, 9, 10, 16, 17], "skip": 16, "selfdelet": 16, "arriv": [8, 10, 16], "prepar": [4, 5, 7, 8, 9, 10, 16], "servicemanag": 16, "dir": 16, "syswow": [3, 16], "systemroot": 16, "windowssystem32": [2, 3, 16], "hklmsoftwaremicrosoft": 16, "noth": [5, 8, 16, 17], "foreground": 16, "someth": [3, 4, 5, 9, 10, 11, 16], "ocl": [8, 16], "termin": [4, 5, 6, 8, 16], "bp": [3, 8, 10, 11, 16], "401133": 16, "breakpoint": [2, 5, 8, 10, 16, 17], "gonna": 16, "decod": [3, 4, 5, 8, 11, 16], "46": 16, "letter": 16, "dump": [5, 6, 8, 10, 11, 16, 17], "anywher": 2, "properli": [2, 3, 4, 8, 9], "origin": [2, 5], "lab10": 2, "sy": 2, "controlservic": 2, "windbg": 2, "kernel": 2, "compon": [2, 6], "stop": [2, 3, 4], "regsetvalu": 2, "0x01": 2, "service_kernel_driv": 2, "0x00000001": 2, "couldnt": 2, "dwcontrol": 2, "service_control_stop": 2, "still": 2, "hit": [2, 5, 8, 10, 17], "break": [2, 5, 10, 17], "lab11": 3, "drop": [3, 4, 8, 9], "rep": 3, "stosd": 3, "ecx": [3, 6, 9, 11], "43h": 3, "tgad": 3, "pestudio": 3, "loadresourc": 3, "40100": [3, 4], "gina": 3, "intercept": 3, "regset": 3, "ginadl": 3, "winlogon": [3, 4], "steal": 3, "credenti": 3, "exeinfo": [3, 10, 17], "floss": [3, 5, 8], "oringin": 3, "stolen": 3, "msutil": 3, "ini": 3, "attempt": [3, 6, 8, 9], "permiss": [3, 17], "resid": 3, "rootkit": 3, "emploi": [3, 8], "hook": [3, 4, 8], "attack": [3, 6], "captur": [3, 6, 17], "activ": [3, 6], "dure": [3, 4, 8, 9], "interest": [3, 5, 6, 7, 10], "lead": [3, 6], "system": [3, 4, 6, 8, 9, 11, 17], "store": [3, 4, 5, 11], "collect": 3, "similar": [3, 4, 6, 7, 8, 9], "caller": 3, "appleinit": 3, "stood": 3, "modulefilenam": 3, "processid": [3, 11], "plu": [3, 5, 6, 8, 9], "snapshottool": 3, "100012fe": 3, "wsock32": 3, "got": [3, 4, 11], "10001203": 3, "virtualprotect": [3, 17], "inlin": 3, "insid": [3, 4, 5, 8, 9], "calcul": [3, 4], "distanc": [3, 6], "arg_4": 3, "sendaddr": 3, "0xff": 3, "lpaddress": 3, "rel": 3, "rest": [3, 9, 17], "0xe9": 3, "jmp": [3, 7, 8, 9, 11], "v6": 3, "trace": [3, 5, 6, 10], "back": [3, 5, 6, 8], "1000113d": 3, "substr": 3, "rept": 3, "els": [3, 5, 9], "recepi": 3, "email": 3, "100034a0": [], "destin": [3, 5, 9], "gibberish": 3, "100010b3": 3, "de": 3, "loaddll": 3, "outlook": 3, "mark": [3, 5, 17], "keylogg": [3, 9], "record": 3, "save": [3, 4, 7, 11, 17], "manipul": [3, 5, 7, 8], "ofc": 3, "inet_epar32": 3, "cisvc": 3, "lpfilenam": 3, "lea": 3, "401070": 3, "full": [3, 10], "windowssystem32cisvc": 3, "409030": 3, "mem": 3, "simpl": [3, 4, 5], "memcopi": 3, "reveal": 3, "assembli": [3, 7, 8], "syswow64": 3, "ran": [3, 5], "had": [3, 4], "didnt": [3, 10], "meant": 3, "10001000": 3, "getasyncst": 3, "kernel64": 3, "kernel64x": 3, "a1": 3, "shift": 3, "cap": 3, "lock": 3, "left": 3, "160": 3, "161": 3, "capit": 3, "content": [3, 5, 6, 7], "specif": 3, "1032": 3, "field": [3, 6, 8], "4q1": 3, "appinit": 3, "link": 3, "librari": [3, 5, 6, 10, 17], "everi": [3, 5], "interfac": 3, "user32": 3, "mechan": [3, 5, 8], "custom": [3, 5, 6, 7, 10], "allow": [3, 6], "behavior": 3, "applic": [3, 5, 17], "who": 3, "elev": 3, "solid": 3, "hklm": [3, 6], "nt": 3, "appinit_dl": 3, "third": [3, 8, 17], "resum": 3, "anoth": [3, 4, 5, 7, 8, 9, 10, 11, 17], "lab12": [4, 9], "much": [4, 8], "let": [4, 6, 7, 17], "pull": 4, "createremotethread": [4, 9], "sai": [4, 5], "list": [4, 6, 9], "sub_401000": 4, "almost": 4, "printprocessnameandid": 4, "psapi": 4, "enumer": [4, 7, 9], "pop": [4, 10, 11, 17], "launcher": 4, "hide": [4, 5, 6], "filesystem": [4, 11], "residu": [4, 11], "0x401000": 4, "accomplish": 4, "loadlibrarya": 4, "fourth": 4, "wmic": 4, "part": 4, "enumprocessmodul": 4, "enumprocess": 4, "getmodulebasenamea": 4, "suggest": 4, "dwprocessid": 4, "v14": 4, "size": [4, 5, 17], "dword": 4, "said": 4, "overhead": 4, "done": 4, "written": [4, 5], "messagebox": 4, "applicationnam": 4, "svchost": [4, 9], "40149d": 4, "40132c": 4, "concaten": 4, "systemdirectori": 4, "unicod": 4, "doesnt": 4, "mz": [4, 10], "401000": [4, 5, 6, 8, 11], "yup": 4, "65": 4, "4010ea": 4, "lpbuffer": 4, "lpapplicationnam": 4, "virtualfre": 4, "suspend": 4, "creationflag": 4, "0x4": 4, "entrypoint": [4, 8, 10, 17], "discuss": 4, "zwunmapviewofsect": 4, "releas": [4, 8], "writeprocessmemori": [4, 11], "final": [4, 6], "restor": 4, "setthreadcontext": 4, "entri": [4, 10], "resumethread": 4, "hollow": 4, "docod": 4, "hidden": [4, 17], "consol": 4, "cmdshow": 4, "threadid": 4, "idhook": 4, "procedur": 4, "fn": 4, "hmod": 4, "getmodulehandl": 4, "wh_keyboard_l": 4, "context": [4, 5], "callnexthookexa": 4, "chain": 4, "messag": 4, "keyboard": 4, "4010c7": 4, "keep": [4, 10], "mind": 4, "capslock": 4, "setwindowshookexa": 4, "associ": 4, "40312c": 4, "403128": 4, "anyth": 4, "refrenc": 4, "resolv": 4, "automat": 4, "401174": 4, "sfc_o": 4, "net": 4, "exampl": [4, 5, 6, 9], "ntcore": 4, "wfp": 4, "disabl": [4, 8, 9], "backup": 4, "wupdmgr": 4, "4011fc": 4, "101": 4, "bin": [4, 5, 11, 17], "legit": 4, "5q5": [], "lab13": 5, "avail": [5, 6], "element": [5, 6], "base64": [5, 6], "labrari": 5, "virtualalloc": [5, 10, 17], "mem0ri": 5, "fakenet": [5, 6], "allthingsdfir": 5, "wow64cpu": 5, "didn": [5, 7], "a2xhc2gtuem": 5, "pastebin": 5, "potenti": [5, 9], "overview": 5, "fucntion": 5, "401300": [5, 8], "wsa": 5, "winsock": [5, 6], "4011c9": 5, "endlessli": 5, "infer": 5, "end": [5, 6, 7], "3bh": 5, "arguemnt": [5, 6], "findcrypt2": 5, "krypto": 5, "kanal": 5, "entropi": 5, "plugin": [5, 10], "tabl": [5, 9, 10], "portion": 5, "correspond": 5, "onto": 5, "group": [5, 6], "pad": [5, 6, 17], "sub_4010b1": 5, "v8": 5, "maximum": 5, "length": 5, "divisbl": 5, "strncpy": 5, "max": 5, "ever": 5, "hostnam": [5, 7], "determin": [5, 6, 8], "prospect": 5, "sourc": [5, 6, 9], "algorithm": 5, "instrument": 5, "recov": 5, "cryptograph": 5, "encrypt": [5, 17], "suffici": 5, "known": [5, 6], "decrypt": [5, 17], "produc": [], "seemingli": 5, "numberofbyetowrit": 5, "getdc": 5, "devic": 5, "dc": 5, "client": 5, "desktop": 5, "bitmap": 5, "screenshot": 5, "kinda": 5, "hard": [5, 6, 17], "expect": [5, 9], "401880": 5, "4018b8": 5, "top": [5, 17], "010": 5, "past": 5, "bmp": 5, "extens": 5, "bm": 5, "immun": 5, "debugg": [5, 8, 11, 17], "immlib": 5, "usr": 5, "env": 5, "def": [5, 11], "imm": 5, "setbreakpoint": 5, "0x00401875": 5, "arg": 5, "until": 5, "crypto": 5, "cfile": 5, "klash": 5, "binarycollect": 5, "chapter_13l": 5, "temp00c6d5db": 5, "rb": 5, "evalu": 5, "theread": 5, "prematur": 5, "sz": 5, "len": [5, 9, 11], "membuf": 5, "remotevirtualalloc": 5, "writememori": 5, "reg": 5, "getreg": 5, "writelong": 5, "0x0040190a": 5, "typic": [5, 9, 11], "cach": [5, 6], "These": 5, "403166": 5, "402da8": 5, "4027ed": 5, "40223a": 5, "401ac2": 5, "count": [5, 6], "scheme": [5, 6], "sub_40352d": 5, "sigsearch": 5, "interesting_1": 5, "ae": 5, "interesting_3": 5, "cdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzab0123456789": 5, "advanc": 5, "standard": [5, 6], "ijklmnopqrstuvwx": 5, "fir": 5, "throw": 5, "except": [5, 7, 8, 9], "onlin": 5, "iv": 5, "keysiz": 5, "secret": [5, 7], "4015b7": [5, 8], "hold": 5, "createpip": 5, "tie": 5, "pipe": [5, 6], "stdin": 5, "stdout": 5, "suspect": [5, 7, 10], "actual": [5, 7], "grab": [5, 6], "c2": 5, "sigsrch": 5, "te1": 5, "initiati": 5, "degre": 6, "develop": 6, "often": 6, "deal": 6, "lab14": [6, 10], "harm": 6, "advantag": 6, "urlmon": [6, 10], "web": 6, "blend": 6, "beacon": 6, "_sprintf": 6, "4010bb": 6, "var10098": 6, "var": [6, 8], "10098": 6, "getcurrenthwprofilea": 6, "hardwar": [6, 9, 10, 17], "profil": 6, "seen": 6, "currentcontrolset": [6, 9], "hardwareprofil": 6, "1q9": 6, "embed": 6, "translat": 6, "nat": 6, "proxi": 6, "solut": 6, "disguis": 6, "outbound": 6, "likewis": 6, "difficulti": 6, "unusu": [6, 10], "revisit": 6, "v3": 6, "effect": 6, "issu": 6, "header": [6, 17], "usernam": 6, "mistak": 6, "analyst": 6, "tryinh": 6, "think": 6, "futur": 6, "variant": 6, "regex": 6, "column": 6, "dash": 6, "za": 6, "z0": 6, "gm": 6, "configur": [6, 11], "prevent": 6, "imagin": 6, "extern": 6, "disadvantag": 6, "offer": 6, "aspect": 6, "leverag": 6, "kind": 6, "design": 6, "channel": 6, "role": 6, "plai": 6, "arsen": 6, "improv": 6, "conduc": 6, "longlast": 6, "methodologi": 6, "whether": 6, "valid": [6, 7, 9], "introduc": 6, "idea": 6, "target": 6, "independ": 6, "resili": 6, "distinct": 6, "snort": 6, "rule": 6, "urilen": 6, "32": [6, 17], "pcre": 6, "getx20": [], "sid": 6, "20001411": 6, "rev": 6, "alert": 6, "tcp": 6, "home_net": 6, "external_net": 6, "http_port": 6, "msg": 6, "pm14": 6, "colon": 6, "x20": 6, "deploi": 6, "asset": 6, "redirect": 6, "bot": 6, "defend": 6, "variou": 6, "defens": 6, "infrastructur": 6, "reason": 6, "fact": 6, "wininet": 6, "One": 6, "desir": [6, 7], "cooki": 6, "v": 6, "winhttp": 6, "winus": 6, "loadstringa": 6, "backdoor": 6, "recompil": 6, "stdoutput": 6, "stdinput": 6, "peeknamepip": 6, "401750": 6, "prepend": 6, "wxyzlabcd3fghijko12e456789abcdefghijkl": 6, "mnopqrstuvmn0pqrstuvwxyz": 6, "4015c0": 6, "401800": 6, "surf": 6, "though": 6, "background": 6, "exit": [6, 8, 9, 17], "propmt": 6, "outgo": 6, "he": 6, "incom": 6, "distinguish": 6, "appar": 6, "alphabet": 6, "http_header": 6, "20001421": 6, "20001422": 6, "b64": 6, "x0d": 6, "20001423": 6, "dropper": 6, "self": [6, 8, 9], "destruct": [6, 8], "anti": [7, 8, 9], "lab15": 7, "red": 7, "absolut": [7, 8, 9], "did": 7, "wrongli": 7, "disassembl": 7, "401010": 7, "rogu": 7, "insert": [7, 17], "trick": 7, "disappear": 7, "e8": [7, 17], "clean": 7, "hover": 7, "p": [7, 8], "psuedocod": 7, "proce": 7, "pdq": 7, "countermeasur": 7, "gener": 7, "coupl": 7, "eb": 7, "imposs": 7, "nope": 7, "exchang": 7, "rot1": 7, "bamboo": 7, "cut": 7, "2q12": [], "account": [7, 8], "xl": 7, "glanc": 7, "legitim": 7, "advertis": 7, "openprocess": 7, "seh": [7, 8], "forc": [7, 8, 9], "divid": 7, "handler": [7, 8, 9], "misinterpret": 7, "exact": 7, "simpli": [7, 10], "immedi": [7, 8], "4014e0": 7, "xore": [7, 11], "ff": 7, "github": [7, 8], "oalab": 7, "hexcopi": 7, "403010": 7, "edit": [7, 8], "403040": 7, "tt": 7, "spoolsrv": 7, "retn": [7, 10], "prematurli": 7, "lab16": 0, "beingdebug": 8, "struct": 8, "_peb": 8, "peb": 8, "f": [8, 9, 11], "30h": 8, "processheap": 8, "0x18h": 8, "forceflag": 8, "0x10h": 8, "ntglobalflag": 8, "0x68": 8, "0x70": 8, "care": 8, "succe": [8, 9], "scyllahid": 8, "x64dbg": 8, "debuggng": 8, "runtim": [8, 9], "0xx": 8, "strncmp": 8, "callback": 8, "ctrl": 8, "incorrect": 8, "again": [8, 11, 17], "ss": 8, "sneaki": 8, "tl": 8, "findwindow": 8, "str2": 8, "startaddress": 8, "alter": 8, "40123a": 8, "bzrrp": 8, "bzrr": 8, "outputdebugstringa": 8, "4010610": 8, "introduct": 8, "stuck": 8, "gettickcount": 8, "queryperformancecount": 8, "elaps": 8, "high": 8, "divis": 8, "attach": 8, "larger": 8, "4b0h": 8, "1200": 8, "var_118": 8, "enclos": 8, "edx": [8, 11], "ret": 8, "crash": 8, "eip": [8, 11], "401006": 8, "40100b": 8, "edi": [8, 11], "2ch": 8, "reserv": 8, "x32dbg": [8, 9, 10, 11], "modifii": 8, "talk": 8, "outsid": 8, "peo": 8, "mention": [8, 9], "rdtsc": 8, "pseudo": 8, "better": 8, "clock": 8, "cycl": 8, "0x7a120": 8, "4010e0": 8, "debuge": 8, "catch": 8, "own": 8, "slowli": 8, "adg": 8, "malwareanalsysisbook": 8, "17": 0, "refactor": 9, "idautil": 9, "idc": 9, "idaapi": 9, "antivm": 9, "head": 9, "mnem": 9, "print_insn_mnem": 9, "sidt": 9, "sgdt": 9, "sldt": 9, "smsw": 9, "cpuid": 9, "append": [9, 11], "addr": 9, "set_item_color": 9, "0x0000ff": 9, "lab17": 9, "401100": 9, "findantivm": 9, "underli": 9, "diverg": 9, "guest": 9, "idt": 9, "interrupt": 9, "descriptor": 9, "dt": 9, "access": 9, "invok": 9, "trap": 9, "presenc": 9, "none": 9, "virtualbox": 9, "multiprocessor": 9, "processor": 9, "nop": [9, 11], "acceler": 9, "installrt": 9, "installsa": 9, "installsb": 9, "xinstal": 9, "Of": 9, "iexplor": 9, "Not": 9, "atoi": 9, "integ": 9, "dvm": 9, "0d": 9, "10006119": 9, "10006196": 9, "_except_handler3": 9, "stru_10016438": 9, "larg": 9, "0x564d5868": 9, "var_1c": 9, "ebx": [9, 10], "repli": 9, "old": 9, "0xa": 9, "0x5668": 9, "vx": 9, "dx": 9, "port": 9, "upon": 9, "emul": 9, "sub_1000d3d0": 9, "10003592": 9, "getmodulefilenamea": 9, "getsystemdirectorya": 9, "10004249": 9, "sub_1000372b": 9, "runnnig": 9, "higher": 9, "1000d10d": 9, "1000d920": 9, "ir": 9, "team": 9, "offens": 9, "secur": 9, "servicemain": 9, "4011c0": 9, "deviceclass": 9, "autom": 10, "won": [10, 17], "skill": 10, "packer": 10, "task": 10, "lab18": 10, "05": 10, "veri": 10, "stand": 10, "stub": 10, "dread": 10, "tail": 10, "0x8000": 10, "awai": 10, "weird": 10, "esp": 10, "pushad": 10, "scylla": 10, "oep": 10, "iat": 10, "autosearch": 10, "getprocadress": 10, "auto": 10, "isn": 10, "want": [10, 17], "wrong": 10, "hop": 10, "pecompact": 10, "18ff7c": 10, "7efde000": 10, "76f43368": 10, "popad": 10, "aspack": 10, "v2": 10, "quit": 10, "usual": 10, "die": 10, "upack": 10, "pstudio": [10, 17], "incomplet": 10, "x32": [10, 17], "cover": 11, "inspir": 11, "shellcod": 11, "cannot": 11, "shellcode_launch": 11, "analys": 11, "appendix": 11, "lab19": 11, "hxd": [11, 17], "sled": 11, "41": 11, "inc": 11, "bufferoverflow": 11, "0x18dh": 11, "397": 11, "21f": 11, "loc_208": 11, "esi": 11, "lodsb": 11, "si": 11, "shl": 11, "jit": 11, "sub_208": 11, "ord": 11, "input_data": 11, "bytearrai": 11, "fromhex": 11, "494a4f4649424f4d45414141414141414f4a444441424141414146474648494c48454345414d44425050504d44424d414b4d44494f414845414b4d424d50414e41424d484f4a4f50505050505049504a50494650464f4d43414541414741494c474d4345434543494c4546444d494c46454146484941424f4b494c454b4249494c464b434141424f4c4f44434b454a494c4445494c41424f4f46474f494c4c50505050445050444c45454345434948464f4d494c464b434541424f4c4747494c414d454c494c464b424d41424f4c494c4145494c41424f494f4a414341414141414142424d41494a45454345424d47424d4341494141464744424d414745494c4541444149464d4148494150494c4541414d494c4841424d4b4e494c454141494f4a414641414141414f4a504c505050504650464f4d44464c4f494e4a5050505049504a4d43474949454f414f4f4d46434f494949415050504950494a4546504d47494d42484a4f464c4946434f4948435050505049444c45454345434948464f4d494c464b434541424f4c4747494c414d454c494c464b424d41424f4c494c4145494c41424f494f4a414341414141414142424d41494a45454345424d47424d4341494141464744424d414745494c4541444149464d4148494150494c4541414d494c4841424d4b4e494c454141494f4a414641414141414f4a504c505050504650464f4d44464c4f494e4a5050505049504a4d43474949454f414f4f4d46434f494949415050504950494a4546504d47494d42484a4f464c4946434f4948435050505049444c45454345434948464f4d494c464b434541424f4c4747494c414d454c494c464b424d41424f4c494c4145494c41424f494f4a414341414141414142424d41494a45454345424d47424d4341494141464744424d41474549": 11, "output_data": 11, "upper": 11, "scdbg": 11, "findsc": 11, "leav": 11, "excal": 11, "later": 11, "hkey_classes_roothttpshellopencommand": 11, "browser": 11, "401180": 11, "401230": 11, "injector": 11, "lpbaseaddress": 11, "407048": 11, "0xe7": 11, "rang": 11, "0x18f": 11, "407030": 11, "princess": 0, "locker": 0, "demonstr": [], "lab20": [], "0x401040": [], "danger": [], "possibli": [], "sensit": [], "0x4011d9": [], "0x401349": [], "implement": [], "sha256": 17, "dc7ab2e7ed26554a11da51a184e95b01e685b1a2f99c7fc77d54d5966530bf60": 17, "li": 17, "gui": 17, "antidebug": 17, "careful": 17, "garbag": 17, "ahead": 17, "rdata": 17, "0x20": 17, "grabag": 17, "corrupt": 17, "0x014c": 17, "littl": 17, "endian": 17, "4c": 17, "fix": 17, "align": 17, "raw": 17, "31000": 17, "30000": 17, "misalign": 17, "earlier": 17, "beacaus": 17, "smaller": 17, "121900": 17, "That": 17, "convult": 17, "lcqhnocpfc": 17, "122b40": 17, "cant": 17, "Will": 17, "roam": 17, "vnjjcgkc": 17, "pyo": 17, "folder": 17, "createfil": 17, "creationdisposit": 17, "probabl": 17, "123780": 17, "drive": 17, "124040": 17, "recycl": 17, "127e30": 17, "saw": 17, "complement": 17, "ffffff": 17, "wont": 17, "volum": 17, "temporari": 17, "x86": 17, "appdata": 17, "mosach": 17, "1278a0": 17, "122e00": 17, "getdefaultlcid": 17, "1049": 17, "russia": 17, "abort": 17, "ransomwar": 17, "random": 17, "21": 17, "27": 17, "121d50": 17, "acquir": 17, "advapi": 17}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 0, "abdelrahmn": [], "walkthrough": 0, "": [], "document": [], "indic": 0, "tabl": 0, "practic": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "malwar": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "analysi": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "lab": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "1": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "2": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16], "3": [1, 2, 3, 4, 5, 6, 7, 9, 10, 12, 14, 15, 16], "4": [1, 4, 10, 12, 14], "5": [10, 13], "6": 14, "7": 15, "9": 16, "10": 2, "11": 3, "my": 0, "pma": 0, "12": 4, "13": 5, "14": 6, "15": 7, "16": 8, "lab16": 8, "03": 8, "17": 9, "18": 10, "19": 11, "20": [], "princess": 17, "locker": 17}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Practical Malware Analysis - Lab 1": [[1, "practical-malware-analysis-lab-1"]], "Lab 1-1": [[1, "lab-1-1"]], "Lab 1-2": [[1, "lab-1-2"]], "Lab 1-3": [[1, "lab-1-3"]], "Lab 1-4": [[1, "lab-1-4"]], "Practical Malware Analysis - Lab 10": [[2, "practical-malware-analysis-lab-10"]], "Lab 10-1": [[2, "lab-10-1"]], "Lab 10-2": [[2, "lab-10-2"]], "Lab 10-3": [[2, "lab-10-3"]], "Practical Malware Analysis - Lab 11": [[3, "practical-malware-analysis-lab-11"]], "Lab 11-1": [[3, "lab-11-1"]], "Lab 11-2": [[3, "lab-11-2"]], "Lab 11-3": [[3, "lab-11-3"]], "Practical Malware Analysis - Lab 3": [[12, "practical-malware-analysis-lab-3"]], "Lab 3-1": [[12, "lab-3-1"]], "Lab 3-2": [[12, "lab-3-2"]], "Lab 3-3": [[12, "lab-3-3"]], "Lab 3-4": [[12, "lab-3-4"]], "Practical Malware Analysis - Lab 5": [[13, "practical-malware-analysis-lab-5"]], "Lab 5-1": [[13, "lab-5-1"]], "Practical Malware Analysis - Lab 6": [[14, "practical-malware-analysis-lab-6"]], "Lab 6-1": [[14, "lab-6-1"]], "Lab 6-2": [[14, "lab-6-2"]], "Lab 6-3": [[14, "lab-6-3"]], "Lab 6-4": [[14, "lab-6-4"]], "Practical Malware Analysis - Lab 7": [[15, "practical-malware-analysis-lab-7"]], "Lab 7-1": [[15, "lab-7-1"]], "Lab 7-2": [[15, "lab-7-2"]], "Lab 7-3": [[15, "lab-7-3"]], "Practical Malware Analysis - Lab 9": [[16, "practical-malware-analysis-lab-9"]], "Lab 9-1": [[16, "lab-9-1"]], "Lab 9-2": [[16, "lab-9-2"]], "Lab 9-3": [[16, "lab-9-3"]], "Practical Malware Analysis - Lab 12": [[4, "practical-malware-analysis-lab-12"]], "Lab 12-1": [[4, "lab-12-1"]], "Lab 12-2": [[4, "lab-12-2"]], "Lab 12-3": [[4, "lab-12-3"]], "Lab 12-4": [[4, "lab-12-4"]], "Practical Malware Analysis - Lab 13": [[5, "practical-malware-analysis-lab-13"]], "Lab 13-1": [[5, "lab-13-1"]], "Lab 13-2": [[5, "lab-13-2"]], "Lab 13-3": [[5, "lab-13-3"]], "Practical Malware Analysis - Lab 14": [[6, "practical-malware-analysis-lab-14"]], "Lab 14-1": [[6, "lab-14-1"]], "Lab 14-2": [[6, "lab-14-2"]], "Lab 14-3": [[6, "lab-14-3"]], "Practical Malware Analysis - Lab 15": [[7, "practical-malware-analysis-lab-15"]], "Lab 15-1": [[7, "lab-15-1"]], "Lab 15-2": [[7, "lab-15-2"]], "Lab 15-3": [[7, "lab-15-3"]], "Practical Malware Analysis - Lab 16": [[8, "practical-malware-analysis-lab-16"]], "Lab 16-1": [[8, "lab-16-1"]], "Lab 16-2": [[8, "lab-16-2"]], "Lab16-03": [[8, "lab16-03"]], "Practical Malware Analysis - Lab 17": [[9, "practical-malware-analysis-lab-17"]], "Lab 17-1": [[9, "lab-17-1"]], "Lab 17-2": [[9, "lab-17-2"]], "Lab 17-3": [[9, "lab-17-3"]], "Practical Malware Analysis - Lab 18": [[10, "practical-malware-analysis-lab-18"]], "Lab 18-1": [[10, "lab-18-1"]], "Lab 18-2": [[10, "lab-18-2"]], "Lab 18-3": [[10, "lab-18-3"]], "Lab 18-4": [[10, "lab-18-4"]], "Lab 18-5": [[10, "lab-18-5"]], "Practical Malware Analysis - Lab 19": [[11, "practical-malware-analysis-lab-19"]], "Lab 19-1": [[11, "lab-19-1"], [11, "id1"]], "Welcome to my PMA walkthrough!": [[0, "welcome-to-my-pma-walkthrough"]], "Indices and tables": [[0, "indices-and-tables"]], "Princess Locker": [[17, "princess-locker"]]}, "indexentries": {}})