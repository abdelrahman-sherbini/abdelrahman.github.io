Search.setIndex({"docnames": ["index", "lab1/lab1", "lab3/lab3", "lab5/lab5"], "filenames": ["index.rst", "lab1\\lab1.rst", "lab3\\lab3.rst", "lab5\\lab5.rst"], "titles": ["Welcome to abdelrahmn walkthrough!", "Practical Malware Analysis - Lab 1", "Practical Malware Analysis - Lab 3", "Practical Malware Analysis - Lab 5"], "terms": {"index": 0, "modul": [0, 1, 3], "search": [0, 1, 2, 3], "page": 0, "practic": 0, "malwar": 0, "analysi": 0, "lab": 0, "1": 0, "thi": [1, 2, 3], "us": [1, 2, 3], "file": [1, 2, 3], "lab01": 1, "01": [1, 2, 3], "ex": [1, 2, 3], "dll": [1, 2, 3], "tool": [1, 2], "techniqu": 1, "describ": 1, "chapter": [1, 2], "gain": 1, "inform": [1, 2, 3], "about": [1, 3], "answer": 1, "question": [1, 3], "below": 1, "q1": [1, 2, 3], "upload": 1, "http": 1, "www": 1, "virustot": 1, "com": [1, 3], "view": [1, 3], "report": 1, "doe": [1, 3], "either": 1, "match": [1, 3], "ani": [1, 2, 3], "exist": 1, "antiviru": 1, "signatur": [1, 2], "45": 1, "vendor": 1, "flag": [1, 3], "suspici": 1, "55": 1, "imag": [], "1ex": [], "png": [], "2": [0, 3], "3": 0, "4": [0, 3], "q2": [1, 2, 3], "when": [1, 2, 3], "were": 1, "compil": 1, "q3": [1, 2, 3], "ar": [1, 2, 3], "indic": [1, 2], "i": [1, 2, 3], "pack": [1, 2], "obfusc": 1, "If": [1, 2, 3], "so": [1, 2, 3], "what": [1, 2, 3], "q4": [1, 2, 3], "do": [1, 2, 3], "import": [1, 2, 3], "hint": [1, 3], "which": [1, 2, 3], "thei": [1, 2], "q5": [1, 2, 3], "q6": [1, 2, 3], "network": [1, 2, 3], "base": [1, 2, 3], "could": [1, 2, 3], "find": [1, 2, 3], "infect": 1, "machin": 1, "q7": [1, 3], "would": [1, 2], "you": [1, 2, 3], "guess": 1, "purpos": [1, 2], "analyz": [1, 2, 3], "02": [1, 2], "definit": 1, "unpack": 1, "possibl": 1, "program": [1, 2, 3], "": [1, 2, 3], "function": [1, 3], "tell": 1, "host": [1, 2], "identifi": [1, 2, 3], "03": [1, 2], "04": [1, 2], "wa": [1, 3], "ha": [1, 3], "one": [1, 3], "resourc": 1, "section": 1, "hacker": 1, "examin": 1, "extract": 1, "can": [1, 2, 3], "learn": 1, "from": [1, 2, 3], "sun": 1, "dec": 1, "19": 1, "18": 1, "16": 1, "2010": 1, "38": 1, "peid": 1, "moreov": 1, "both": 1, "decent": 1, "number": [1, 3], "psstudio": 1, "check": [1, 3], "show": 1, "creat": [1, 2, 3], "ws2_32": 1, "socket": [1, 3], "mean": 1, "we": [1, 2, 3], "need": [1, 3], "investig": 1, "traffic": [1, 2, 3], "also": [1, 3], "createprocess": 1, "kernel32": [1, 2], "new": 1, "process": [1, 2, 3], "spawn": 1, "ye": 1, "findfirstfil": 1, "findnextfil": 1, "u": [1, 3], "somefil": 1, "modifi": 1, "run": [1, 2], "string": [1, 2, 3], "give": [1, 3], "some": [1, 2, 3], "useful": 1, "like": [1, 2, 3], "ip": 1, "127": 1, "26": 1, "152": 1, "13": [1, 3], "watch": [1, 3], "come": 1, "kerne132": 1, "l": 1, "should": [1, 3], "notic": [1, 2, 3], "sleep": [1, 3], "exec": 1, "mai": [1, 3], "its": [1, 3], "an": [1, 3], "agent": 1, "connect": [1, 2], "c": [1, 3], "server": 1, "trojan": 1, "against": 1, "upx": 1, "bash": [], "d": 1, "code": 3, "block": [], "createservic": 1, "startservic": 1, "start": [1, 2, 3], "servic": 1, "internetopenurl": 1, "internetopen": 1, "open": [1, 3], "specifi": [1, 3], "complet": 1, "ftp": 1, "url": 1, "getmodulefilenam": 1, "obtain": 1, "fulli": 1, "qualifi": 1, "name": [1, 2, 3], "given": 1, "handl": 1, "see": [1, 3], "internet": 1, "explor": [1, 2], "malwareanalysisbook": 1, "8": 1, "0": [1, 3], "64": 1, "av": 1, "fsg": 1, "dulek": [], "look": [1, 3], "manual": 1, "onli": [1, 2, 3], "loadlibrari": 1, "getprocaddress": 1, "t": [1, 2], "63": 1, "No": 1, "malform": 1, "virtuals": 1, "close": 1, "rawsiz": 1, "sat": 1, "aug": 1, "31": 1, "00": 1, "59": 1, "2019": 1, "It": [1, 2, 3], "lookup": 1, "privileg": 1, "adjust": 1, "token": 1, "control": 1, "most": [1, 2, 3], "wupdmgrd": 1, "download": 1, "thepracticalmalwareanalysi": 1, "updat": 1, "There": 1, "binari": 1, "rsrc": 1, "urldownloadtofil": 1, "first": [2, 3], "my": 2, "setup": 2, "two": 2, "vm": 2, "win7": 2, "linux": 2, "togeth": 2, "vmnet": [], "inetsim": 2, "On": 2, "procmon": 2, "set": [2, 3], "filter": 2, "execut": [2, 3], "clear": 2, "out": [2, 3], "all": [2, 3], "event": 2, "just": 2, "befor": [2, 3], "gather": [2, 3], "snapshot": [2, 3], "registri": 2, "regshot": 2, "up": [2, 3], "log": 2, "wireshark": 2, "apatedn": 2, "point": 2, "found": [2, 3], "lab03": 2, "basic": 2, "dynam": 2, "how": [2, 3], "get": [2, 3], "instal": 2, "itself": 2, "after": 2, "under": 2, "order": 2, "glean": 2, "while": 2, "monitor": 2, "safe": 2, "environ": 2, "live": 2, "memori": 2, "modif": 2, "further": 2, "9": [2, 3], "happen": [2, 3], "caus": 2, "roadblock": 2, "other": [2, 3], "wai": 2, "pebear": 2, "exitprocess": 2, "dl": 2, "command": 2, "mani": [2, 3], "domain": 2, "intern": 2, "driver": 2, "By": 2, "utilt": 2, "rundll32": 2, "sc": 2, "parent": 2, "pid": 2, "delet": 2, "processcr": 2, "call": [2, 3], "cmd": [2, 3], "requir": 2, "certain": 2, "condit": 2, "line": [2, 3], "argument": [2, 3], "don": 2, "know": 2, "stage": 2, "util": 3, "ida": 3, "lab05": 3, "pro": 3, "The": 3, "goal": 3, "hand": 3, "experi": 3, "ve": 3, "alreadi": 3, "work": 3, "choos": 3, "ignor": 3, "focu": 3, "revers": 3, "engin": 3, "5": 0, "address": 3, "dllmain": 3, "window": 3, "brows": 3, "gethostbynam": 3, "where": 3, "locat": 3, "focus": 3, "0x10001757": 3, "figur": 3, "dn": 3, "request": 3, "made": 3, "local": 3, "variabl": 3, "recogn": 3, "subroutin": 3, "0x10001656": 3, "6": 3, "paramet": 3, "7": [], "disassembli": 3, "area": 3, "refer": 3, "In": 3, "same": 3, "0x100101c8": 3, "dword_1008e5c4": 3, "global": 3, "help": 3, "decid": 3, "path": 3, "take": 3, "cross": 3, "10": [], "A": 3, "few": 3, "hundr": 3, "0x1000ff58": 3, "seri": 3, "comparison": 3, "memcmp": 3, "compar": 3, "robotwork": 3, "success": 3, "return": 3, "11": [], "export": 3, "pslist": 3, "12": [], "graph": 3, "mode": 3, "sub_10004e79": 3, "api": 3, "enter": 3, "alon": 3, "renam": 3, "directli": 3, "depth": 3, "14": [], "At": 3, "0x10001358": 3, "contain": 3, "millisecond": 3, "backward": 3, "through": 3, "long": 3, "15": [], "0x10001701": 3, "three": 3, "q8": 3, "q9": 3, "q10": 3, "q11": 3, "q12": 3, "q13": 3, "q14": 3, "q15": 3, "load": 3, "direct": 3, "1000d02e": 3, "referenc": 3, "100163cc": 3, "xref": 3, "press": 3, "x": 3, "idata": 3, "time": 3, "uniqu": 3, "method": 3, "g": 3, "jump": 3, "scroll": 3, "push": 3, "eax": 3, "data": 3, "ad": 3, "0x0d": 3, "decim": 3, "go": 3, "click": 3, "twice": 3, "undefin": 3, "place": 3, "redefin": 3, "offset": 3, "pic": 3, "praticalmalwareanalysi": 3, "24": 3, "pass": 3, "posit": 3, "valu": 3, "respect": 3, "ebp": 3, "neg": 3, "lpthreadparamet": 3, "100101d0": 3, "hi": 3, "master": 3, "remot": 3, "shell": 3, "sound": 3, "session": 3, "1001009d": 3, "doubl": 3, "mov": 3, "begin": 3, "initi": 3, "stack": 3, "alloc": 3, "space": 3, "Then": 3, "structur": 3, "versioninform": 3, "pointer": 3, "getversionexa": 3, "zero": 3, "dwplatformid": 3, "equal": 3, "true": 3, "fals": 3, "al": 3, "regist": 3, "result": 3, "overal": 3, "o": 3, "win32nt": 3, "act": 3, "text": 3, "test": 3, "jnz": 3, "next": 3, "instruct": 3, "flow": 3, "sub_100052a2": 3, "routin": 3, "type": 3, "buffer": 3, "send": 3, "over": 3, "try": 3, "registeri": 3, "softwar": 3, "microsoft": 3, "currentvers": 3, "regopenkeyexa": 3, "jz": 3, "loc_10005309": 3, "10005322": 3, "queri": 3, "worktim": 3, "sent": 3, "vaiabl": 3, "dword_1008e5bc": 3, "sub_100036c3": 3, "cmp": 3, "majorvers": 3, "jb": 3, "short": 3, "loc_100036fa": 3, "version": 3, "less": 3, "than": 3, "cf": 3, "goe": 3, "piec": 3, "str": 3, "isnot": 3, "null": 3, "empti": 3, "strlen": 3, "zf": 3, "taken": 3, "non": 3, "1000664c": 3, "10006518": 3, "createtoolhelp32snapshot": 3, "well": 3, "heap": 3, "thread": 3, "processentry32": 3, "put": 3, "loop": 3, "pe": 3, "szexefil": 3, "those": 3, "branch": 3, "seem": 3, "without": 3, "langaug": 3, "getsystemlanguageid": 3, "sprintf": 3, "sub_100038e": 3, "send_languageid": 3, "For": 3, "win": 3, "lot": 3, "10019020": 3, "cti": 3, "30": 3, "move": 3, "add": 3, "convert": 3, "int": 3, "multipli": 3, "1000": 3, "second": 3, "protocol": 3, "af": 3}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 0, "abdelrahmn": 0, "walkthrough": 0, "": [], "document": [], "indic": 0, "tabl": 0, "practic": [1, 2, 3], "malwar": [1, 2, 3], "analysi": [1, 2, 3], "lab": [1, 2, 3], "1": [1, 2, 3], "2": [1, 2], "3": [1, 2], "4": [1, 2], "5": 3}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Practical Malware Analysis - Lab 1": [[1, "practical-malware-analysis-lab-1"]], "Lab 1-1": [[1, "lab-1-1"]], "Lab 1-2": [[1, "lab-1-2"]], "Lab 1-3": [[1, "lab-1-3"]], "Lab 1-4": [[1, "lab-1-4"]], "Practical Malware Analysis - Lab 3": [[2, "practical-malware-analysis-lab-3"]], "Lab 3-1": [[2, "lab-3-1"]], "Lab 3-2": [[2, "lab-3-2"]], "Lab 3-3": [[2, "lab-3-3"]], "Lab 3-4": [[2, "lab-3-4"]], "Welcome to abdelrahmn walkthrough!": [[0, "welcome-to-abdelrahmn-walkthrough"]], "Indices and tables": [[0, "indices-and-tables"]], "Practical Malware Analysis - Lab 5": [[3, "practical-malware-analysis-lab-5"]], "Lab 5-1": [[3, "lab-5-1"]]}, "indexentries": {}})