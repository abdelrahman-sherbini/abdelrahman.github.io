Search.setIndex({"docnames": ["index", "lab1/lab1", "lab10/lab10", "lab11/lab11", "lab12/lab12", "lab13/lab13", "lab3/lab3", "lab5/lab5", "lab6/lab6", "lab7/lab7", "lab9/lab9"], "filenames": ["index.rst", "lab1\\lab1.rst", "lab10\\lab10.rst", "lab11\\lab11.rst", "lab12\\lab12.rst", "lab13\\lab13.rst", "lab3\\lab3.rst", "lab5\\lab5.rst", "lab6\\lab6.rst", "lab7\\lab7.rst", "lab9\\lab9.rst"], "titles": ["Welcome to my PMA walkthrough!", "Practical Malware Analysis - Lab 1", "Practical Malware Analysis - Lab 10", "Practical Malware Analysis - Lab 11", "Practical Malware Analysis - Lab 12", "Practical Malware Analysis - Lab 13", "Practical Malware Analysis - Lab 3", "Practical Malware Analysis - Lab 5", "Practical Malware Analysis - Lab 6", "Practical Malware Analysis - Lab 7", "Practical Malware Analysis - Lab 9"], "terms": {"index": [0, 5], "modul": [0, 1, 3, 4, 7], "search": [0, 1, 3, 4, 5, 6, 7, 9, 10], "page": [0, 5, 7], "practic": 0, "malwar": 0, "analysi": 0, "lab": 0, "1": 0, "thi": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "us": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "file": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "lab01": 1, "01": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "ex": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "dll": [1, 3, 4, 5, 6, 7, 9, 10], "tool": [1, 5, 6], "techniqu": [1, 3, 5, 10], "describ": 1, "chapter": [1, 5, 6, 8, 10], "gain": 1, "inform": [1, 5, 6, 7], "about": [1, 3, 7], "answer": [1, 3, 4, 5, 10], "question": [1, 5, 7, 8, 10], "below": 1, "q1": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "upload": 1, "http": [1, 3, 4, 5, 7, 9, 10], "www": [1, 3, 4, 5, 9, 10], "virustot": 1, "com": [1, 4, 5, 7, 8, 9, 10], "view": [1, 3, 7, 10], "report": 1, "doe": [1, 2, 3, 4, 5, 7, 8, 9, 10], "either": 1, "match": [1, 7, 10], "ani": [1, 2, 3, 5, 6, 7, 8, 9, 10], "exist": 1, "antiviru": 1, "signatur": [1, 6, 9, 10], "45": 1, "vendor": 1, "flag": [1, 5, 7], "suspici": [1, 3], "55": 1, "imag": 3, "1ex": [], "png": 3, "2": [0, 7], "3": [0, 7], "4": [0, 5, 7, 10], "q2": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "when": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "were": [1, 3, 9], "compil": 1, "q3": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "ar": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "indic": [1, 5, 6, 8, 9, 10], "i": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "pack": [1, 6], "obfusc": [1, 10], "If": [1, 2, 3, 5, 6, 7, 8, 9], "so": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "what": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "q4": [1, 3, 4, 5, 6, 7, 8, 9, 10], "do": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "import": [1, 3, 4, 5, 6, 7, 9, 10], "hint": [1, 7], "which": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "thei": [1, 2, 4, 6, 7], "q5": [1, 3, 4, 5, 6, 7, 8, 9, 10], "q6": [1, 3, 4, 5, 6, 7, 8, 9, 10], "network": [1, 5, 6, 7, 8, 9, 10], "base": [1, 3, 4, 5, 6, 7, 8, 9, 10], "could": [1, 4, 6, 7, 9, 10], "find": [1, 3, 4, 5, 6, 7, 9, 10], "infect": [1, 3], "machin": [1, 2, 3, 9], "q7": [1, 3, 5, 7, 10], "would": [1, 3, 5, 6], "you": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "guess": 1, "purpos": [1, 3, 4, 6, 8, 9, 10], "analyz": [1, 3, 4, 5, 6, 7, 8, 9, 10], "02": [1, 2, 3, 4, 5, 6, 8, 9, 10], "definit": 1, "unpack": 1, "possibl": 1, "program": [1, 2, 4, 6, 7, 8, 9, 10], "": [1, 3, 4, 5, 6, 7, 8, 9, 10], "function": [1, 2, 3, 4, 5, 7, 8, 9, 10], "tell": 1, "host": [1, 2, 5, 6, 8, 9, 10], "identifi": [1, 4, 5, 6, 7, 10], "03": [1, 2, 3, 4, 5, 6, 8, 9, 10], "04": [1, 4, 6, 8], "wa": [1, 2, 3, 5, 7, 10], "ha": [1, 4, 5, 7, 8, 10], "one": [1, 3, 4, 5, 7, 8, 9, 10], "resourc": [1, 3, 4, 5], "section": [1, 4, 5], "hacker": 1, "examin": [1, 2, 3], "extract": [1, 3, 4], "can": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "learn": [1, 4, 7], "from": [1, 2, 3, 4, 5, 6, 7, 8, 10], "sun": 1, "dec": 1, "19": 1, "18": 1, "16": [1, 3, 5], "2010": 1, "38": 1, "peid": [1, 5], "moreov": 1, "both": [1, 2, 3, 9, 10], "decent": 1, "number": [1, 4, 7], "psstudio": 1, "check": [1, 2, 3, 4, 5, 7, 8, 9, 10], "show": [1, 10], "creat": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "ws2_32": 1, "socket": [1, 5, 7], "mean": [1, 2, 3, 4], "we": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "need": [1, 2, 3, 5, 7, 9, 10], "investig": 1, "traffic": [1, 5, 6, 7], "also": [1, 3, 4, 5, 7], "createprocess": [1, 5], "kernel32": [1, 6, 9, 10], "new": [1, 3, 5, 8], "process": [1, 3, 4, 5, 6, 7, 9, 10], "spawn": [1, 5], "ye": [1, 8], "findfirstfil": 1, "findnextfil": 1, "u": [1, 4, 7], "somefil": 1, "modifi": [1, 3, 4, 5], "run": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "string": [1, 3, 4, 5, 6, 7, 8, 9, 10], "give": [1, 7], "some": [1, 3, 4, 5, 6, 7, 9, 10], "useful": 1, "like": [1, 3, 4, 5, 6, 7, 8, 9, 10], "ip": [1, 9], "127": [1, 9], "26": [1, 9], "152": [1, 9], "13": [0, 1, 4, 7, 9], "watch": [1, 5, 7], "come": 1, "kerne132": [1, 9], "l": [1, 10], "should": [1, 3, 7, 8, 9], "notic": [1, 3, 4, 5, 6, 7, 9, 10], "sleep": [1, 3, 5, 7, 8], "exec": 1, "mai": [1, 3, 5, 7, 9, 10], "its": [1, 3, 4, 5, 7, 9, 10], "an": [1, 2, 3, 5, 7, 10], "agent": [1, 8, 9], "connect": [1, 5, 6, 8, 9], "c": [1, 2, 3, 5, 7, 8, 9, 10], "server": 1, "trojan": 1, "against": 1, "upx": 1, "bash": [], "d": [1, 8], "code": [3, 4, 5, 7, 8, 10], "block": 5, "createservic": 1, "startservic": [1, 9], "start": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "servic": [1, 2, 9, 10], "internetopenurl": 1, "internetopen": 1, "open": [1, 2, 3, 4, 5, 7, 9, 10], "specifi": [1, 3, 4, 5, 7, 10], "complet": [1, 3, 5], "ftp": 1, "url": [1, 5, 8, 9], "getmodulefilenam": 1, "obtain": [1, 9], "fulli": 1, "qualifi": 1, "name": [1, 2, 3, 4, 5, 6, 7, 9, 10], "given": 1, "handl": [1, 3, 4, 5, 9], "see": [1, 2, 3, 4, 5, 7, 8, 9, 10], "internet": [1, 5, 8, 9], "explor": [1, 4, 6, 8, 9], "malwareanalysisbook": [1, 9], "8": [1, 5, 9], "0": [1, 4, 5, 7], "64": [1, 5], "av": 1, "fsg": 1, "dulek": [], "look": [1, 3, 4, 5, 7, 10], "manual": 1, "onli": [1, 4, 5, 6, 7, 8, 9], "loadlibrari": [1, 4], "getprocaddress": [1, 3], "t": [1, 3, 4, 5, 6, 7, 9, 10], "63": 1, "No": 1, "malform": 1, "virtuals": 1, "close": 1, "rawsiz": 1, "sat": 1, "aug": 1, "31": [1, 10], "00": 1, "59": 1, "2019": 1, "It": [1, 3, 4, 5, 6, 7, 8, 9, 10], "lookup": 1, "privileg": [1, 3], "adjust": 1, "token": 1, "control": [1, 9], "most": [1, 3, 6, 7, 8], "wupdmgrd": 1, "download": [1, 5], "thepracticalmalwareanalysi": 1, "updat": [1, 3, 4], "There": [1, 7, 8], "binari": [1, 3, 5, 10], "rsrc": [1, 3, 4, 5], "urldownloadtofil": 1, "first": [3, 4, 5, 6, 7, 8, 9, 10], "my": [3, 5, 6], "setup": [6, 9], "two": [4, 5, 6, 8, 9], "vm": [6, 7], "win7": 6, "linux": 6, "togeth": [5, 6], "vmnet": [], "inetsim": 6, "On": [4, 6], "procmon": [2, 3, 4, 5, 6, 10], "set": [2, 3, 4, 5, 6, 7, 8, 9, 10], "filter": [2, 6], "execut": [2, 3, 4, 5, 6, 7, 8, 9, 10], "clear": [3, 6], "out": [3, 6, 7, 8, 10], "all": [3, 4, 5, 6, 7, 9, 10], "event": [4, 6], "just": [3, 4, 5, 6], "befor": [5, 6, 7, 8], "gather": [4, 5, 6, 7], "snapshot": [3, 6, 7, 9], "registri": [2, 3, 6, 8], "regshot": 6, "up": [4, 6, 7], "log": [3, 4, 6], "wireshark": [3, 6], "apatedn": 6, "point": [3, 4, 6], "found": [2, 3, 4, 5, 6, 7, 8, 9, 10], "lab03": 6, "basic": [3, 6, 10], "dynam": [3, 5, 6, 9, 10], "how": [2, 3, 4, 5, 6, 7, 8, 9, 10], "get": [3, 4, 5, 6, 7, 9, 10], "instal": [3, 4, 6, 7, 9, 10], "itself": [4, 6, 10], "after": [2, 3, 4, 5, 6, 7, 8, 9, 10], "under": [3, 6, 9, 10], "order": [2, 3, 6, 9], "glean": 6, "while": [4, 6, 10], "monitor": [3, 6], "safe": 6, "environ": [3, 4, 6], "live": 6, "memori": [2, 3, 4, 5, 6, 9, 10], "modif": 6, "further": [6, 7], "9": [0, 6, 7], "happen": [3, 4, 6, 7, 10], "caus": [6, 9], "roadblock": 6, "other": [5, 6, 7, 8, 9], "wai": [3, 6, 9], "pebear": 6, "exitprocess": 6, "dl": 6, "command": [4, 5, 6, 8, 9, 10], "mani": [3, 6, 7, 10], "domain": [6, 10], "intern": 6, "driver": [2, 6], "By": [4, 6, 7, 9, 10], "utilt": 6, "rundll32": [3, 6], "sc": [6, 9], "parent": 6, "pid": [4, 6], "delet": [6, 8, 10], "processcr": 6, "call": [2, 3, 4, 5, 6, 7, 8, 9, 10], "cmd": [3, 4, 5, 6, 7, 10], "requir": [4, 6, 10], "certain": [3, 6, 9], "condit": [3, 6, 8, 10], "line": [6, 7, 10], "argument": [2, 3, 4, 6, 7, 8, 10], "don": [4, 6], "know": [2, 5, 6, 9], "stage": 6, "util": [7, 9, 10], "ida": [2, 3, 4, 5, 7, 10], "lab05": 7, "pro": [5, 7, 10], "The": [2, 3, 5, 7, 8, 10], "goal": [7, 8], "hand": 7, "experi": 7, "ve": [5, 7, 8, 9], "alreadi": [2, 7], "work": [2, 3, 7, 8], "choos": 7, "ignor": 7, "focu": [7, 9], "revers": [5, 7, 9], "engin": 7, "5": [0, 3, 8], "address": [3, 4, 7, 8, 9, 10], "dllmain": [3, 7, 9], "window": [2, 3, 4, 5, 7, 8, 9], "brows": 7, "gethostbynam": 7, "where": [2, 3, 4, 5, 7, 10], "locat": [3, 4, 7, 8, 10], "focus": [5, 7], "0x10001757": 7, "figur": 7, "dn": 7, "request": [5, 7, 10], "made": [7, 8], "local": [4, 7, 9], "variabl": [4, 5, 7], "recogn": [7, 8], "subroutin": [7, 8, 9, 10], "0x10001656": 7, "6": [0, 7, 10], "paramet": [3, 4, 5, 7, 8, 10], "7": [0, 3], "disassembli": [5, 7], "area": [5, 7], "refer": [3, 5, 7], "In": [4, 5, 7, 8, 9, 10], "same": [2, 3, 4, 5, 7, 8, 9, 10], "0x100101c8": 7, "dword_1008e5c4": 7, "global": [4, 7], "help": [3, 7, 8], "decid": 7, "path": [3, 5, 7, 10], "take": [3, 5, 7, 8, 10], "cross": [3, 4, 5, 7], "10": 0, "A": [5, 7, 8, 9], "few": 7, "hundr": 7, "0x1000ff58": 7, "seri": 7, "comparison": [5, 7], "memcmp": [3, 7], "compar": [3, 4, 5, 7, 8, 10], "robotwork": 7, "success": [2, 5, 7, 8, 9], "return": [2, 3, 4, 5, 7, 8, 10], "11": 0, "export": [3, 7], "pslist": 7, "12": [0, 5], "graph": 7, "mode": [3, 5, 7], "sub_10004e79": 7, "api": 7, "enter": 7, "alon": 7, "renam": [5, 7, 10], "directli": [4, 5, 7], "depth": 7, "14": [], "At": [7, 9], "0x10001358": 7, "contain": [3, 4, 5, 7, 8, 9], "millisecond": 7, "backward": 7, "through": [5, 7, 8, 9], "long": [7, 8], "15": [], "0x10001701": 7, "three": [3, 5, 7, 10], "q8": [3, 5, 7, 10], "q9": [3, 5, 7], "q10": 7, "q11": 7, "q12": 7, "q13": 7, "q14": 7, "q15": 7, "load": [3, 4, 5, 7, 10], "direct": [2, 7], "1000d02e": 7, "referenc": 7, "100163cc": 7, "xref": 7, "press": [3, 4, 7], "x": 7, "idata": 7, "time": [3, 5, 7, 8, 9], "uniqu": 7, "method": [5, 7, 8, 9], "g": 7, "jump": [3, 7, 8], "scroll": 7, "push": [5, 7, 8], "eax": [2, 3, 7, 8, 10], "data": [3, 5, 7, 9, 10], "ad": [7, 8, 9], "0x0d": 7, "decim": 7, "go": [2, 3, 4, 5, 7, 8, 9, 10], "click": 7, "twice": 7, "undefin": [3, 7], "place": [2, 3, 4, 7], "redefin": 7, "offset": [3, 7, 9], "pic": 7, "praticalmalwareanalysi": 7, "24": 7, "pass": [3, 4, 5, 7, 8, 9, 10], "posit": 7, "valu": [3, 5, 7, 10], "respect": 7, "ebp": [3, 5, 7], "neg": 7, "lpthreadparamet": 7, "100101d0": 7, "hi": 7, "master": 7, "remot": [4, 7, 9], "shell": [5, 7], "sound": [3, 5, 7], "session": 7, "1001009d": 7, "doubl": 7, "mov": [7, 10], "begin": [7, 9], "initi": [4, 5, 7, 10], "stack": [5, 7, 10], "alloc": [3, 4, 5, 7], "space": [2, 3, 4, 7], "Then": [2, 4, 7, 8, 9], "structur": [3, 5, 7], "versioninform": 7, "pointer": [4, 7], "getversionexa": 7, "zero": [2, 3, 4, 5, 7], "dwplatformid": 7, "equal": [4, 7, 10], "true": [5, 7], "fals": 7, "al": [7, 8], "regist": [4, 7, 9, 10], "result": [2, 3, 7], "overal": [7, 8], "o": [5, 7, 8], "win32nt": 7, "act": 7, "text": 7, "test": [3, 7, 10], "jnz": [7, 8], "next": [4, 7, 8], "instruct": [3, 5, 7, 8, 10], "flow": [3, 4, 7, 10], "sub_100052a2": 7, "routin": [3, 4, 5, 7, 8, 10], "type": [2, 3, 4, 5, 7, 8], "buffer": [3, 4, 5, 7], "send": [3, 5, 7, 9], "over": [3, 4, 5, 7, 10], "try": [7, 8], "registeri": 7, "softwar": [3, 7, 8, 9], "microsoft": [3, 4, 7, 8], "currentvers": [3, 7, 8], "regopenkeyexa": 7, "jz": [7, 8], "loc_10005309": 7, "10005322": 7, "queri": [5, 7, 10], "worktim": 7, "sent": [3, 4, 5, 7], "vaiabl": 7, "dword_1008e5bc": 7, "sub_100036c3": 7, "cmp": [7, 8], "majorvers": 7, "jb": 7, "short": 7, "loc_100036fa": 7, "version": [7, 9], "less": [5, 7], "than": [5, 7, 9], "cf": 7, "goe": 7, "piec": [7, 8, 10], "str": [5, 7], "isnot": 7, "null": [5, 7], "empti": [5, 7], "strlen": 7, "zf": 7, "taken": [7, 9], "non": [2, 5, 7], "1000664c": 7, "10006518": 7, "createtoolhelp32snapshot": 7, "well": [3, 7], "heap": [3, 7], "thread": [3, 4, 5, 7, 9], "processentry32": [3, 7], "put": [2, 3, 5, 7, 8, 10], "loop": [3, 4, 5, 7, 8, 9, 10], "pe": 7, "szexefil": 7, "those": [3, 5, 7, 8], "branch": [4, 7, 10], "seem": [3, 5, 7], "without": [5, 7, 9], "langaug": 7, "getsystemlanguageid": 7, "sprintf": 7, "sub_100038e": 7, "send_languageid": 7, "For": [4, 5, 7, 9], "win": [3, 7], "lot": [3, 4, 5, 7], "10019020": 7, "cti": 7, "30": 7, "move": [7, 10], "add": [3, 5, 7], "convert": [4, 7, 10], "int": [5, 7], "multipli": 7, "1000": 7, "second": [3, 4, 5, 7, 8, 10], "protocol": 7, "af": 7, "q16": 7, "msdn": [4, 7], "symbol": 7, "constant": [3, 5, 7], "make": [2, 3, 4, 7, 9, 10], "more": [3, 7, 8, 9], "meaning": 7, "appli": 7, "chang": [2, 3, 7, 9], "q17": 7, "usag": 7, "opcod": [3, 7], "0xed": 7, "magic": [5, 7], "vmxh": 7, "perform": [4, 7, 8], "vmware": 7, "detect": [7, 9], "evid": 7, "q18": 7, "your": [3, 5, 7, 9], "cursor": 7, "0x1001d988": 7, "q19": 7, "have": [2, 3, 7], "python": [5, 7], "plug": 7, "includ": [2, 7, 10], "commerci": 7, "py": 7, "script": [5, 7], "provid": [3, 7, 10], "book": [5, 7], "sure": [3, 4, 7], "q20": 7, "With": 7, "turn": 7, "singl": [4, 5, 7, 8], "ascii": [7, 8, 10], "q21": 7, "editor": [5, 7], "_target": 7, "en": [4, 7], "win32": [4, 7], "winsock2": 7, "nf": 7, "right": [3, 7], "alt": 7, "b": [5, 7, 8], "byte": [3, 4, 5, 7, 8], "occur": 7, "sub_10006196": 7, "hex": [5, 7, 10], "cancel": 7, "charact": [3, 4, 5, 7], "outdat": 7, "xor": [4, 5, 7, 10], "0x55": 7, "default": [5, 7, 8], "format": [3, 7, 8], "current": [3, 7, 8], "select": 7, "screen": 7, "0x50": 7, "understand": 8, "construct": 8, "each": [4, 5, 8], "guid": 8, "discov": [3, 8], "build": 8, "previou": [8, 9], "thu": 8, "complic": 8, "four": 8, "onc": [2, 4, 8, 9], "finish": [5, 8, 9], "abl": 8, "easili": 8, "individu": 8, "encount": 8, "them": [3, 5, 8], "lab06": 8, "major": 8, "main": [3, 4, 5, 8, 9, 10], "print": [3, 8, 10], "state": [4, 8], "output": [4, 5, 8, 10], "0x40105f": 8, "oper": [3, 4, 8], "0x40117f": 8, "ll": [8, 9], "differ": [8, 10], "between": [3, 8], "been": 8, "pars": 8, "html": [4, 8, 9], "assum": [3, 8], "abov": [3, 4, 5], "stream": [5, 8], "fail": [2, 8], "printf": 8, "here": [2, 3, 4, 5, 8, 9, 10], "tri": [5, 8], "openurl": 8, "practicalmalwareanalysi": [4, 5, 8, 10], "v7": [3, 4, 5, 8], "depend": 8, "continu": [3, 4, 8, 9], "internetreadfil": 8, "read": [3, 5, 8], "200": 8, "readfil": 8, "bye": 8, "0x3c": 8, "receiv": 8, "combin": [8, 9], "bunch": 8, "switch": 8, "case": 8, "user": [2, 3, 5, 8, 9], "As": [5, 8, 10], "summari": 8, "pma": 8, "cc": [8, 10], "htm": [3, 4, 8], "401130": 8, "lpexistingfil": 8, "char": [5, 8], "argv": [8, 10], "arrai": [5, 8], "lower": 8, "401040": [8, 9], "input": [3, 4, 5, 8], "directori": [2, 3, 4, 8, 9], "temp": 8, "copi": [3, 4, 5, 8, 9], "kei": [3, 4, 5, 8, 10], "persist": [3, 8, 9], "startup": [8, 9], "e": [3, 8, 10], "100": 8, "error": 8, "multipl": [3, 8], "thing": [5, 8], "retriev": [5, 8], "site": [8, 9], "1440": 8, "counter": 8, "var_c": 8, "parser": 8, "throughtout": 8, "dai": [3, 8], "interv": 8, "lab07": 9, "ensur": [4, 9], "achiev": [3, 9], "comput": [2, 9], "restart": [4, 9], "why": [3, 9], "mutex": [3, 9], "good": [5, 9], "malici": [4, 5, 9, 10], "prior": 9, "note": 9, "becaus": [2, 3, 9], "might": [3, 5, 9], "victim": [2, 4, 9], "visibl": 9, "loopback": 9, "real": 9, "localhost": 9, "protect": [3, 4, 5, 9], "warn": 9, "consider": 9, "damag": 9, "difficult": 9, "remov": [5, 9], "virtual": 9, "bit": [3, 9], "challeng": 9, "ones": 9, "static": [3, 5, 9, 10], "big": 9, "pictur": 9, "avoid": [9, 10], "bog": 9, "down": 9, "detail": 9, "Into": [5, 9], "startservicectrldispatchera": 9, "manag": [4, 9, 10], "instanc": 9, "startyp": 9, "autostart": 9, "pc": [5, 9], "To": 9, "hardcod": 9, "must": [2, 3, 5, 9], "consist": 9, "aren": 9, "commun": 9, "qc": 9, "malservic": 9, "hgl345": 9, "waitforsingleobject": 9, "waitabl": 9, "timer": 9, "wait": 9, "2100": 9, "834h": 9, "4010de": 9, "reach": [9, 10], "year": 9, "20": [3, 9], "zombi": 9, "botnet": 9, "infinit": [5, 9], "never": 9, "object": 9, "oleiniti": 9, "cocreateinst": 9, "our": [5, 9, 10], "hkey_local_machin": 9, "class": 9, "clsid": 9, "2df01": 9, "mayb": [3, 4, 5, 9], "adwar": 9, "now": [3, 4, 5, 9, 10], "eplor": 9, "uninti": 9, "normal": [3, 9], "ioc": 9, "system32": [2, 3, 4, 9, 10], "map": [3, 4, 5, 9], "reflect": 9, "disk": [3, 9], "And": 9, "132": 9, "l32": 9, "4011e0": 9, "iter": 9, "string2": 9, "replac": [3, 4, 5, 9], "dword_403010": 9, "qmemcpi": 9, "ping": 9, "pong": 9, "reciev": [5, 9], "overwrit": [3, 9], "instead": [5, 9], "sadfhuhf": 9, "inject": [3, 4, 9], "logic": [2, 9], "Or": 9, "easier": [9, 10], "lab09": 10, "ollydbg": [3, 5, 10], "follow": [4, 5, 10], "option": 10, "password": 10, "perman": 10, "patch": 10, "doesn": [3, 10], "special": [4, 10], "action": 10, "via": [5, 10], "sampl": 10, "payload": [4, 10], "0x00401133": 10, "being": [3, 4, 5, 10], "0x00401089": 10, "encod": [4, 5, 10], "signific": [3, 10], "createprocessa": 10, "0x0040106e": 10, "dll1": 10, "dll2": 10, "dll3": 10, "built": 10, "therefor": 10, "versu": 10, "appear": 10, "comfort": 10, "correct": 10, "within": [4, 5, 10], "debug": [3, 10], "assign": 10, "writefil": [5, 10], "filenam": [3, 5, 10], "write": [3, 4, 5, 10], "job": 10, "netschedulejobadd": 10, "mysteri": 10, "sub_402410": 10, "del": 10, "respons": [3, 5, 10], "last": 10, "argc": 10, "abcd": 10, "passkei": 10, "n": 10, "r": 10, "involv": 10, "around": 10, "re": 10, "opposit": 10, "suppli": 10, "xp": [3, 10], "subkei": 10, "arugu": 10, "qw": 10, "402af0": 10, "step": [4, 10], "till": [5, 10], "sinc": [5, 10], "skip": 10, "selfdelet": 10, "arriv": 10, "prepar": [4, 5, 10], "servicemanag": 10, "dir": 10, "syswow": [3, 10], "systemroot": 10, "windowssystem32": [2, 3, 10], "hklmsoftwaremicrosoft": 10, "noth": [5, 10], "foreground": 10, "someth": [3, 4, 5, 10], "ocl": 10, "termin": [4, 5, 10], "bp": [3, 10], "401133": 10, "breakpoint": [2, 5, 10], "gonna": 10, "decod": [3, 4, 5, 10], "46": 10, "letter": 10, "dump": [5, 10], "anywher": 2, "properli": [2, 3, 4], "origin": [2, 5], "lab10": 2, "sy": 2, "controlservic": 2, "windbg": 2, "kernel": 2, "compon": 2, "stop": [2, 3, 4], "regsetvalu": 2, "0x01": 2, "service_kernel_driv": 2, "0x00000001": 2, "couldnt": 2, "dwcontrol": 2, "service_control_stop": 2, "still": 2, "hit": [2, 5], "break": [2, 5], "lab11": 3, "drop": [3, 4], "rep": 3, "stosd": 3, "ecx": 3, "43h": 3, "tgad": 3, "pestudio": 3, "loadresourc": 3, "40100": [3, 4], "gina": 3, "intercept": 3, "regset": 3, "ginadl": 3, "winlogon": [3, 4], "steal": 3, "credenti": 3, "exeinfo": 3, "floss": [3, 5], "oringin": 3, "stolen": 3, "msutil": 3, "ini": 3, "attempt": 3, "permiss": 3, "resid": 3, "rootkit": 3, "emploi": 3, "hook": [3, 4], "attack": 3, "captur": 3, "activ": 3, "dure": [3, 4, 5], "interest": [3, 5], "lead": 3, "system": [3, 4], "store": [3, 4, 5], "collect": 3, "similar": [3, 4], "caller": 3, "appleinit": 3, "stood": 3, "modulefilenam": 3, "processid": 3, "plu": [3, 5], "snapshottool": 3, "100012fe": 3, "wsock32": 3, "got": [3, 4], "10001203": 3, "virtualprotect": 3, "inlin": 3, "insid": [3, 4, 5], "calcul": [3, 4], "distanc": 3, "arg_4": 3, "sendaddr": 3, "0xff": 3, "lpaddress": 3, "rel": 3, "rest": 3, "0xe9": 3, "jmp": 3, "v6": 3, "trace": [3, 5], "back": [3, 5], "1000113d": 3, "substr": 3, "rept": 3, "els": [3, 5], "recepi": 3, "email": 3, "100034a0": [], "destin": [3, 5], "gibberish": 3, "100010b3": 3, "de": 3, "loaddll": 3, "outlook": 3, "mark": [3, 5], "keylogg": 3, "record": 3, "save": [3, 4], "manipul": [3, 5], "ofc": 3, "inet_epar32": 3, "cisvc": 3, "lpfilenam": 3, "lea": 3, "401070": 3, "full": 3, "windowssystem32cisvc": 3, "409030": 3, "mem": 3, "simpl": [3, 4, 5], "memcopi": 3, "reveal": 3, "assembli": 3, "syswow64": 3, "ran": [3, 5], "had": [3, 4], "didnt": 3, "meant": 3, "10001000": 3, "getasyncst": 3, "kernel64": 3, "kernel64x": 3, "a1": 3, "shift": 3, "cap": 3, "lock": 3, "left": 3, "160": 3, "161": 3, "capit": 3, "content": [3, 5], "specif": 3, "1032": 3, "field": 3, "4q1": 3, "appinit": 3, "link": 3, "librari": [3, 5], "everi": [3, 5], "interfac": 3, "user32": 3, "mechan": [3, 5], "custom": [3, 5], "allow": 3, "behavior": 3, "applic": [3, 5], "who": 3, "elev": 3, "solid": 3, "hklm": 3, "nt": 3, "appinit_dl": 3, "third": 3, "resum": 3, "anoth": [3, 4, 5], "lab12": 4, "much": 4, "let": 4, "pull": 4, "createremotethread": 4, "sai": [4, 5], "list": 4, "sub_401000": 4, "almost": 4, "printprocessnameandid": 4, "psapi": 4, "enumer": 4, "pop": 4, "launcher": 4, "hide": [4, 5], "filesystem": 4, "residu": 4, "0x401000": 4, "accomplish": 4, "loadlibrarya": 4, "fourth": 4, "wmic": 4, "part": 4, "enumprocessmodul": 4, "enumprocess": 4, "getmodulebasenamea": 4, "suggest": 4, "dwprocessid": 4, "v14": 4, "size": [4, 5], "dword": 4, "said": 4, "overhead": 4, "done": 4, "written": [4, 5], "messagebox": 4, "applicationnam": 4, "svchost": 4, "40149d": 4, "40132c": 4, "concaten": 4, "systemdirectori": 4, "unicod": 4, "doesnt": 4, "mz": 4, "401000": [4, 5], "yup": 4, "65": 4, "4010ea": 4, "lpbuffer": 4, "lpapplicationnam": 4, "virtualfre": 4, "suspend": 4, "creationflag": 4, "0x4": 4, "entrypoint": 4, "discuss": 4, "zwunmapviewofsect": 4, "releas": 4, "writeprocessmemori": 4, "final": 4, "restor": 4, "setthreadcontext": 4, "entri": 4, "resumethread": 4, "hollow": 4, "docod": 4, "hidden": 4, "consol": 4, "cmdshow": 4, "threadid": 4, "idhook": 4, "procedur": 4, "fn": 4, "hmod": 4, "getmodulehandl": 4, "wh_keyboard_l": 4, "context": [4, 5], "callnexthookexa": 4, "chain": 4, "messag": 4, "keyboard": 4, "4010c7": 4, "keep": 4, "mind": 4, "capslock": 4, "setwindowshookexa": 4, "associ": 4, "40312c": 4, "403128": 4, "anyth": 4, "refrenc": 4, "resolv": 4, "automat": 4, "401174": 4, "sfc_o": 4, "net": 4, "exampl": [4, 5], "ntcore": 4, "wfp": 4, "disabl": 4, "backup": 4, "wupdmgr": 4, "4011fc": 4, "101": 4, "bin": [4, 5], "legit": 4, "5q5": [], "lab13": 5, "avail": 5, "element": 5, "base64": 5, "labrari": 5, "virtualalloc": 5, "mem0ri": 5, "fakenet": 5, "allthingsdfir": 5, "wow64cpu": 5, "didn": 5, "a2xhc2gtuem": 5, "pastebin": 5, "potenti": 5, "overview": 5, "fucntion": 5, "401300": 5, "wsa": 5, "winsock": 5, "4011c9": 5, "endlessli": 5, "infer": 5, "end": 5, "3bh": 5, "arguemnt": 5, "findcrypt2": 5, "krypto": 5, "kanal": 5, "entropi": 5, "plugin": 5, "tabl": 5, "portion": 5, "correspond": 5, "onto": 5, "group": 5, "pad": 5, "sub_4010b1": 5, "v8": 5, "maximum": 5, "length": 5, "divisbl": 5, "strncpy": 5, "max": 5, "ever": 5, "hostnam": 5, "determin": 5, "prospect": 5, "sourc": 5, "algorithm": 5, "instrument": 5, "recov": 5, "cryptograph": 5, "encrypt": 5, "suffici": 5, "known": 5, "decrypt": 5, "produc": 5, "seemingli": 5, "numberofbyetowrit": 5, "getdc": 5, "devic": 5, "dc": 5, "client": 5, "desktop": 5, "bitmap": 5, "screenshot": 5, "kinda": 5, "hard": 5, "expect": 5, "401880": 5, "4018b8": 5, "top": 5, "010": 5, "past": 5, "bmp": 5, "extens": 5, "bm": 5, "immun": 5, "debugg": 5, "immlib": 5, "usr": 5, "env": 5, "def": 5, "imm": 5, "setbreakpoint": 5, "0x00401875": 5, "arg": 5, "until": 5, "crypto": 5, "cfile": 5, "klash": 5, "binarycollect": 5, "chapter_13l": 5, "temp00c6d5db": 5, "rb": 5, "evalu": 5, "theread": 5, "prematur": 5, "sz": 5, "len": 5, "membuf": 5, "remotevirtualalloc": 5, "writememori": 5, "reg": 5, "getreg": 5, "writelong": 5, "0x0040190a": 5, "typic": 5, "cach": 5, "These": 5, "403166": 5, "402da8": 5, "4027ed": 5, "40223a": 5, "401ac2": 5, "count": 5, "scheme": 5, "sub_40352d": 5, "sigsearch": 5, "interesting_1": 5, "ae": 5, "interesting_3": 5, "cdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzab0123456789": 5, "advanc": 5, "standard": 5, "ijklmnopqrstuvwx": 5, "fir": 5, "throw": 5, "except": 5, "onlin": 5, "iv": 5, "keysiz": 5, "secret": 5, "4015b7": 5, "hold": 5, "createpip": 5, "tie": 5, "pipe": 5, "stdin": 5, "stdout": 5, "suspect": 5, "actual": 5, "grab": 5, "c2": 5, "sigsrch": 5, "te1": 5}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 0, "abdelrahmn": [], "walkthrough": 0, "": [], "document": [], "indic": 0, "tabl": 0, "practic": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "malwar": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "analysi": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "lab": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "1": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "2": [1, 2, 3, 4, 5, 6, 8, 9, 10], "3": [1, 2, 3, 4, 5, 6, 8, 9, 10], "4": [1, 4, 6, 8], "5": 7, "6": 8, "7": 9, "9": 10, "10": 2, "11": 3, "my": 0, "pma": 0, "12": 4, "13": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Practical Malware Analysis - Lab 1": [[1, "practical-malware-analysis-lab-1"]], "Lab 1-1": [[1, "lab-1-1"]], "Lab 1-2": [[1, "lab-1-2"]], "Lab 1-3": [[1, "lab-1-3"]], "Lab 1-4": [[1, "lab-1-4"]], "Practical Malware Analysis - Lab 10": [[2, "practical-malware-analysis-lab-10"]], "Lab 10-1": [[2, "lab-10-1"]], "Lab 10-2": [[2, "lab-10-2"]], "Lab 10-3": [[2, "lab-10-3"]], "Practical Malware Analysis - Lab 11": [[3, "practical-malware-analysis-lab-11"]], "Lab 11-1": [[3, "lab-11-1"]], "Lab 11-2": [[3, "lab-11-2"]], "Lab 11-3": [[3, "lab-11-3"]], "Practical Malware Analysis - Lab 3": [[6, "practical-malware-analysis-lab-3"]], "Lab 3-1": [[6, "lab-3-1"]], "Lab 3-2": [[6, "lab-3-2"]], "Lab 3-3": [[6, "lab-3-3"]], "Lab 3-4": [[6, "lab-3-4"]], "Practical Malware Analysis - Lab 5": [[7, "practical-malware-analysis-lab-5"]], "Lab 5-1": [[7, "lab-5-1"]], "Practical Malware Analysis - Lab 6": [[8, "practical-malware-analysis-lab-6"]], "Lab 6-1": [[8, "lab-6-1"]], "Lab 6-2": [[8, "lab-6-2"]], "Lab 6-3": [[8, "lab-6-3"]], "Lab 6-4": [[8, "lab-6-4"]], "Practical Malware Analysis - Lab 7": [[9, "practical-malware-analysis-lab-7"]], "Lab 7-1": [[9, "lab-7-1"]], "Lab 7-2": [[9, "lab-7-2"]], "Lab 7-3": [[9, "lab-7-3"]], "Practical Malware Analysis - Lab 9": [[10, "practical-malware-analysis-lab-9"]], "Lab 9-1": [[10, "lab-9-1"]], "Lab 9-2": [[10, "lab-9-2"]], "Lab 9-3": [[10, "lab-9-3"]], "Practical Malware Analysis - Lab 12": [[4, "practical-malware-analysis-lab-12"]], "Lab 12-1": [[4, "lab-12-1"]], "Lab 12-2": [[4, "lab-12-2"]], "Lab 12-3": [[4, "lab-12-3"]], "Lab 12-4": [[4, "lab-12-4"]], "Welcome to my PMA walkthrough!": [[0, "welcome-to-my-pma-walkthrough"]], "Indices and tables": [[0, "indices-and-tables"]], "Practical Malware Analysis - Lab 13": [[5, "practical-malware-analysis-lab-13"]], "Lab 13-1": [[5, "lab-13-1"]], "Lab 13-2": [[5, "lab-13-2"]], "Lab 13-3": [[5, "lab-13-3"]]}, "indexentries": {}})